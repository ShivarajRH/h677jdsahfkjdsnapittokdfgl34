ALTER TABLE `pnh_sch_discount_track` ADD COLUMN `dealid` BIGINT(0) NULL AFTER `catid`; 
ALTER TABLE `pnh_sch_discount_brands` ADD COLUMN `dealid` BIGINT(11) DEFAULT 0 NULL AFTER `discount`;  


## Reconcilation and Reciept status date updates 
CREATE TABLE `t_deal_publish_changelog` (                
                            `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,         
                            `item_id` BIGINT(20) UNSIGNED NOT NULL,                
                            `is_publish` TINYINT(1) DEFAULT '0',                   
                            `remarks` TEXT,                                        
                            `created_by` INT(10) DEFAULT '0',                      
                            `created_on` DATETIME NOT NULL,                        
                            PRIMARY KEY (`id`)                                     
                          );


CREATE TABLE `pnh_t_receipt_reconcilation` (   
                               `id` BIGINT(20) NOT NULL AUTO_INCREMENT,     
                               `debit_note_id` BIGINT(20) DEFAULT '0',      
                               `invoice_no` BIGINT(20) DEFAULT NULL,        
                               `dispatch_id` INT(100) DEFAULT NULL,         
                               `inv_amount` DOUBLE DEFAULT '0',             
                               `unreconciled` DOUBLE DEFAULT '0',           
                               `created_on` INT(50) DEFAULT NULL,           
                               `created_by` INT(20) DEFAULT NULL,           
                               `modified_on` VARCHAR(50) DEFAULT NULL,      
                               `modified_by` INT(20) DEFAULT NULL,          
                               `is_invoice_cancelled` INT(20) DEFAULT '0',  
                               PRIMARY KEY (`id`)                           
                             );

CREATE TABLE `pnh_t_receipt_reconcilation_log` (  
                                   `logid` BIGINT(20) NOT NULL AUTO_INCREMENT,     
                                   `credit_note_id` INT(50) DEFAULT NULL,          
                                   `receipt_id` INT(50) DEFAULT NULL,              
                                   `reconcile_id` INT(50) DEFAULT NULL,            
                                   `is_invoice_cancelled` INT(20) DEFAULT '0',     
                                   `reconcile_amount` DOUBLE DEFAULT '0',          
                                   `is_reversed` INT(11) DEFAULT '0',              
                                   `created_on` INT(100) DEFAULT NULL,             
                                   `created_by` INT(20) DEFAULT NULL,              
                                   `remarks` VARCHAR(100) DEFAULT NULL,            
                                   PRIMARY KEY (`logid`)                           
                                 ) ;
ALTER TABLE `pnh_t_receipt_info` ADD COLUMN `unreconciliation_amount` DOUBLE  DEFAULT '0' NULL  AFTER `receipt_amount`;
ALTER TABLE `pnh_franchise_account_stat` ADD COLUMN `unreconciled_value` DOUBLE   NULL  AFTER `is_correction`, ADD COLUMN `unreconciled_status` VARCHAR (11) DEFAULT 'pending' NULL  AFTER `unreconciled_value`;
#update pnh_t_receipt_info set unreconciliation_amount = receipt_amount;
ALTER TABLE `pnh_franchise_account_summary` ADD COLUMN `unreconciled_value` DOUBLE  DEFAULT '0' NULL  AFTER `created_by`, ADD COLUMN `unreconciled_status` VARCHAR (50) DEFAULT 'pending' NULL  AFTER `unreconciled_value`;
 

ALTER TABLE pnh_t_receipt_info ADD COLUMN cheq_realized_on VARCHAR(255) AFTER activated_on; 
ALTER TABLE pnh_m_deposited_receipts ADD COLUMN cheq_cancelled_on DATETIME AFTER dbt_amt;

CREATE TABLE `pnh_acknowledgement_print_log` (
`sno` BIGINT(20) NOT NULL AUTO_INCREMENT,
`log_id` VARCHAR(150) DEFAULT NULL,
`tm_emp_id` VARCHAR(100) DEFAULT NULL,
`be_emp_id` VARCHAR(100) DEFAULT NULL,
`p_inv_no` VARCHAR(100) NOT NULL,
`created_on` VARCHAR(50) DEFAULT NULL,
`created_by` INT(30) DEFAULT NULL,
`status` INT(10) DEFAULT '0',
`count` INT(100) DEFAULT '0',
PRIMARY KEY (`sno`)
);

# Apr_04_2014
ALTER TABLE `pnh_member_insurance` ADD COLUMN `mem_receipt_no` BIGINT NULL AFTER `pincode`,
 ADD COLUMN `mem_receipt_date` DATE NULL AFTER `mem_receipt_no`,
  ADD COLUMN `mem_receipt_amount` DOUBLE NULL AFTER `mem_receipt_date`, CHANGE `created_by` `created_by` TINYINT(20) NULL,
   CHANGE `created_on` `created_on` DATETIME NULL, ADD COLUMN `modified_by` TINYINT(20) NULL AFTER `created_on`,
    ADD COLUMN `modified_on` DATETIME NULL AFTER `modified_by`;

ALTER TABLE `pnh_member_offers` CHANGE `created_on` `created_on` DATETIME NULL, ADD COLUMN `modified_by` TINYINT(20) NULL AFTER `created_on`, ADD COLUMN `modified_on` DATETIME NULL AFTER `modified_by`;
ALTER TABLE `pnh_member_offers_log` ADD COLUMN `created_on` DATETIME NULL AFTER `status`, ADD COLUMN `created_by` TINYINT(20) NULL AFTER `created_on`;
ALTER TABLE `pnh_member_insurance` ADD INDEX (`fid`, `mid`, `opted_insurance`, `offer_status`, `itemid`, `mob_no`); 
ALTER TABLE `pnh_member_offers` ADD INDEX (`member_id`, `franchise_id`, `offer_type`, `pnh_pid`, `transid_ref`, `insurance_id`, `process_status`);
ALTER TABLE `pnh_member_insurance_menu` ADD INDEX (`menu_id`, `greater_than`, `less_than`, `is_active`);

# =========================================================================
#Apr_05_2014
UPDATE pnh_member_offers mo 
JOIN pnh_member_insurance mi ON mi.insurance_id = mo.insurance_id
SET mo.insurance_id=mi.sno;

# =========================================================================
#Apr_07_2014
#order_id field added
ALTER TABLE `pnh_member_insurance` ADD COLUMN `order_id` BIGINT NULL AFTER `itemid`;
ALTER TABLE `pnh_member_offers` ADD COLUMN `order_id` BIGINT NULL AFTER `pnh_pid`;

# To insert order id in member offers table
UPDATE pnh_member_offers mo 
JOIN king_dealitems di ON `pnh_id` = mo.`pnh_pid`
JOIN king_orders o ON o.itemid = di.id AND o.transid=mo.`transid_ref`
SET mo.`order_id` = o.`id`;

# To insert order id in member insurance table
UPDATE pnh_member_offers mo 
JOIN pnh_member_insurance mi ON mi.sno = mo.`insurance_id`
JOIN king_dealitems di ON `pnh_id` = mo.`pnh_pid`
JOIN king_orders o ON o.itemid = di.id AND o.transid=mo.`transid_ref`
SET mi.`order_id` = o.`id`;
# =========================================================================

/*---Vendor deal import throug api db changes--*/
CREATE TABLE `m_vendor_api_info` (                       
                     `id` BIGINT(20) NOT NULL AUTO_INCREMENT,               
                     `vendor_id` BIGINT(20) DEFAULT NULL,                   
                     `api_link` VARCHAR(255) DEFAULT NULL,                  
                     `type` VARCHAR(255) DEFAULT NULL,                      
                     PRIMARY KEY (`id`)                                     
                   );

CREATE TABLE `m_client_brand_link` (                     
                       `id` BIGINT(20) NOT NULL AUTO_INCREMENT,               
                       `brand_id` BIGINT(20) DEFAULT NULL,                    
                       `client_brand` VARCHAR(255) DEFAULT NULL,              
                       `created_on` DATETIME DEFAULT NULL,                    
                       `created_by` INT(11) DEFAULT NULL,                     
                       PRIMARY KEY (`id`)                                     
                     );
CREATE TABLE `m_client_category_link` (                  
                          `id` BIGINT(20) NOT NULL AUTO_INCREMENT,               
                          `category_id` BIGINT(20) DEFAULT NULL,                 
                          `client_category` VARCHAR(255) DEFAULT NULL,           
                          `created_on` DATETIME DEFAULT NULL,                    
                          `created_by` INT(11) DEFAULT NULL,                     
                          PRIMARY KEY (`id`)                                     
                        );
CREATE TABLE `t_vendor_product_import_log` (                       
                               `id` BIGINT(20) NOT NULL AUTO_INCREMENT,                         
                               `vendor_id` BIGINT(20) DEFAULT NULL,                             
                               `type` VARCHAR(255) DEFAULT NULL,                                
                               `data` TEXT,                                                     
                               `status` INT(1) DEFAULT NULL COMMENT '1:updated,2:not updated',  
                               `msg` TEXT,                                                      
                               `created_on` DATETIME DEFAULT NULL,                              
                               `created_by` INT(11) DEFAULT NULL,                               
                               `modified_on` DATETIME DEFAULT NULL,                             
                               `modified_by` INT(11) DEFAULT NULL,                              
                               PRIMARY KEY (`id`)                                               
                             );
CREATE TABLE `m_client_menu_link` (                      
                      `id` BIGINT(20) NOT NULL AUTO_INCREMENT,               
                      `menu_id` BIGINT(20) DEFAULT NULL,                     
                      `client_menu` VARCHAR(255) DEFAULT NULL,               
                      `created_on` DATETIME DEFAULT NULL,                    
                      `created_by` INT(11) DEFAULT NULL,                     
                      PRIMARY KEY (`id`)                                     
                    );

ALTER TABLE `king_orders` ADD COLUMN `order_from_vendor` INT (11)  NULL  AFTER `insurance_amount`, ADD COLUMN `vendor_order_refe_id` VARCHAR (255)  NULL  AFTER `order_from_vendor`
ALTER TABLE `king_orders` DROP COLUMN `product_id`,ADD COLUMN `order_product_id` BIGINT (20)  NULL  AFTER `itemid`
ALTER TABLE `t_vendor_deal_import_log` ADD COLUMN `vendor_id` BIGINT (20)  NULL  AFTER `id`;

/*---Vendor deal import throug api db changes--*/

# Apr_08_2014
#DROP TABLE IF EXISTS pnh_loyalty_points;
CREATE TABLE `pnh_loyalty_points` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  `menu_id` BIGINT(15) DEFAULT NULL,
  `amount` INT(10) UNSIGNED NOT NULL,
  `points` INT(10) UNSIGNED NOT NULL,
  `is_active` TINYINT(11) DEFAULT '1',
  `valid_days` BIGINT(11) DEFAULT NULL,
  `created_on` DATETIME DEFAULT NULL,
  `updated_on` DATETIME DEFAULT NULL,
  `created_by` INT(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
);

ALTER TABLE `pnh_member_insurance` ADD COLUMN `status_ship` TINYINT(11) DEFAULT 0 NULL AFTER `mem_receipt_amount`, ADD COLUMN `status_deliver` TINYINT(11) DEFAULT 0 NULL AFTER `status_ship`;
#=====================================================================

# Apr_10_2014
ALTER TABLE `king_orders` ADD COLUMN `pnh_member_fee` DOUBLE NULL AFTER `vendor_order_refe_id`;
CREATE TABLE `m_vendor_product_images` (    
                           `id` BIGINT(20) NOT NULL AUTO_INCREMENT,  
                           `vendor_id` BIGINT(20) DEFAULT NULL,      
                           `item_id` BIGINT(20) DEFAULT NULL,        
                           `main_image` MEDIUMTEXT,                  
                           `other_images` TEXT,                      
                           `created_by` INT(11) DEFAULT NULL,        
                           `created_on` DATETIME DEFAULT NULL,       
                           PRIMARY KEY (`id`)                        
                         );
ALTER TABLE `m_vendor_info` ADD COLUMN `api_access_key` VARCHAR (255)  NULL  AFTER `vendor_code`;
ALTER TABLE `t_vendor_product_import_log` ADD COLUMN `group_id` BIGINT (20)  NULL  AFTER `vendor_id`;
ALTER TABLE `m_product_info` CHANGE `product_name` `product_name` VARCHAR (200)  NULL  COLLATE utf8_general_ci 

#=====================================================================
# Apr_12_2014
ALTER TABLE `king_orders` ADD COLUMN `loyality_point_value` DOUBLE NULL AFTER `pnh_member_fee`;

# Added pnh_member_fee field
ALTER TABLE `pnh_member_offers` ADD COLUMN `pnh_member_fee` FLOAT(25) NULL AFTER `mem_fee_applicable`; 

# set member fee in offers table
UPDATE pnh_member_offers mo SET mo.pnh_member_fee = 50 WHERE mem_fee_applicable = 1;
#=====================================================================
#Apr_15_2014
CREATE TABLE `pnh_member_fee`( `id` BIGINT(11) NOT NULL AUTO_INCREMENT, `member_id` INT(10) DEFAULT 0, `transid` VARCHAR(25), `invoice_no` BIGINT(11) DEFAULT 0, `amount` DOUBLE, `status` TINYINT(1) DEFAULT 0, `created_on` DATETIME, `created_by` INT(5) DEFAULT 0, `modified_on` DATETIME, `modified_by` INT(5) DEFAULT 0, PRIMARY KEY (`id`) );
#===============================================

// NON SK IMEI PROCESS DB Changes

CREATE TABLE `non_sk_imei_insurance_orders` (
  `id` BIGINT(11) NOT NULL AUTO_INCREMENT,
  `franchise_id` BIGINT(11) DEFAULT NULL,
  `order_id` BIGINT(15) DEFAULT NULL,
  `transid` VARCHAR(255) DEFAULT NULL,
  `userid` BIGINT(11) DEFAULT NULL,
  `member_id` BIGINT(11) DEFAULT NULL,
  `nonsk_imei_no` VARCHAR(255) DEFAULT NULL,
  `model_no` VARCHAR(255) DEFAULT NULL,
  `model_value` DOUBLE(10,2) DEFAULT '0.00',
  `insurance_id` BIGINT(11) DEFAULT NULL,
  `insurance_amount` DOUBLE(10,2) NOT NULL DEFAULT '0.00',
  `pnh_member_fee` DOUBLE(10,2) NOT NULL DEFAULT '0.00',
  `created_on` DATETIME DEFAULT NULL,
  `created_by` INT(12) DEFAULT NULL,
  PRIMARY KEY (`id`)
) 

ALTER TABLE `king_orders` CHANGE `insurance_amount` `insurance_amount` DOUBLE(10,2) DEFAULT 0.00 NOT NULL, CHANGE `pnh_member_fee` `pnh_member_fee` DOUBLE(10,2) DEFAULT 0.00 NOT NULL; 

#================================================================================================
#Apr_16_2014
ALTER TABLE `king_transactions` ADD COLUMN `order_for` INT(11) DEFAULT 0 NOT NULL AFTER `credit_days`;
#================================================================================================
# Apr_18_2014
CREATE TABLE `pnh_member_insurance_printlog`( `id` BIGINT(11) NOT NULL AUTO_INCREMENT, `insurance_id` BIGINT(11), `printcount` INT(150) DEFAULT 0, `printed_by` TINYINT(11) DEFAULT 0, `last_printed_on` DATETIME, PRIMARY KEY (`id`) );
#====================================================
# Apr_19_2014
ALTER TABLE king_orders ADD COLUMN lpoints_valid_days DOUBLE AFTER loyality_point_value;
#====================================================
# Apr_22_2014
ALTER TABLE `pnh_member_offers` ADD COLUMN `remarks` VARCHAR(100) NULL AFTER `referred_status`;
#=====================================================

/*[4:33:00 PM][2366 ms]*/ ALTER TABLE `king_orders` ADD COLUMN `has_nonsk_imei_insurance` TINYINT(11) DEFAULT 0 NOT NULL AFTER `pnh_member_fee`; 
#================================================================================================
# Apr_24_2014
CREATE TABLE `nonskimei_mem_fee_insu_amt` (
  `id` BIGINT(11) NOT NULL AUTO_INCREMENT,
  `member_id` INT(10) DEFAULT '0',
  `transid` VARCHAR(25) DEFAULT NULL,
  `invoice_no` BIGINT(11) DEFAULT '0',
  `pnh_member_fee` DOUBLE DEFAULT NULL,
  `insurance_amt` DOUBLE DEFAULT NULL,
  `status` TINYINT(1) DEFAULT '0',
  `created_on` DATETIME DEFAULT NULL,
  `created_by` INT(5) DEFAULT '0',
  `modified_on` DATETIME DEFAULT NULL,
  `modified_by` INT(5) DEFAULT '0',
  PRIMARY KEY (`id`)
);
#=====================================================
# Apr_25_2014
INSERT INTO `m_config_params` (`name`, `value`) VALUES ('FRAN_TYPE_ELECTRONIC', '112,102');
#======================================================
#Apr_25_4_2014
ALTER TABLE `m_vendor_api_info` ADD COLUMN `file_format` ENUM ('CSV','XML','TXT') DEFAULT 'CSV' NULL  AFTER `type`, ADD COLUMN `mapping_tmpl_id` INT (11)  NULL  AFTER `file_format`;
CREATE TABLE `m_vendor_api_templates` (                  
                          `id` BIGINT(20) NOT NULL AUTO_INCREMENT,               
                          `product_name` VARCHAR(255) DEFAULT NULL,              
                          `sku_code` VARCHAR(255) DEFAULT NULL,                  
                          `product_code` VARCHAR(255) DEFAULT NULL,              
                          `model_code` VARCHAR(255) DEFAULT NULL,                
                          `qty` VARCHAR(255) DEFAULT NULL,                       
                          `short_description` VARCHAR(255) DEFAULT NULL,         
                          `category` VARCHAR(255) DEFAULT NULL,                  
                          `category1` VARCHAR(255) DEFAULT NULL,                 
                          `category2` VARCHAR(255) DEFAULT NULL,                 
                          `category3` VARCHAR(255) DEFAULT NULL,                 
                          `category4` VARCHAR(255) DEFAULT NULL,                 
                          `brand` VARCHAR(255) DEFAULT NULL,                     
                          `menu` VARCHAR(255) DEFAULT NULL,                      
                          `unit_of_measurement` VARCHAR(255) DEFAULT NULL,       
                          `mrp` VARCHAR(255) DEFAULT NULL,                       
                          `offer_price` VARCHAR(255) DEFAULT NULL,               
                          `vat` VARCHAR(255) DEFAULT NULL,                       
                          `purchase_cost` VARCHAR(255) DEFAULT NULL,             
                          `barcode` VARCHAR(255) DEFAULT NULL,                   
                          `group_id` VARCHAR(255) DEFAULT NULL,                  
                          `gender_attr` VARCHAR(255) DEFAULT NULL,               
                          `long_description` VARCHAR(255) DEFAULT NULL,          
                          `main_image` VARCHAR(255) DEFAULT NULL,                
                          `image1` VARCHAR(255) DEFAULT NULL,                    
                          `image2` VARCHAR(255) DEFAULT NULL,                    
                          `image3` VARCHAR(255) DEFAULT NULL,                    
                          `image4` VARCHAR(255) DEFAULT NULL,                    
                          `image5` VARCHAR(255) DEFAULT NULL,                    
                          `color` VARCHAR(255) DEFAULT NULL,                     
                          `size` VARCHAR(255) DEFAULT NULL,                      
                          `attr1` VARCHAR(255) DEFAULT NULL,                     
                          `attr2` VARCHAR(255) DEFAULT NULL,                     
                          `spec1` VARCHAR(255) DEFAULT NULL,                     
                          `spec2` VARCHAR(255) DEFAULT NULL,                     
                          `spec3` VARCHAR(255) DEFAULT NULL,                     
                          `spec4` VARCHAR(255) DEFAULT NULL,                     
                          `spec5` VARCHAR(255) DEFAULT NULL,                     
                          `spec6` VARCHAR(255) DEFAULT NULL,                     
                          `spec7` VARCHAR(255) DEFAULT NULL,                     
                          `spec8` VARCHAR(255) DEFAULT NULL,                     
                          `spec9` VARCHAR(255) DEFAULT NULL,                     
                          `spec10` VARCHAR(255) DEFAULT NULL,                    
                          `spec11` VARCHAR(255) DEFAULT NULL,                    
                          `spec12` VARCHAR(255) DEFAULT NULL,                    
                          `spec13` VARCHAR(255) DEFAULT NULL,                    
                          `spec14` VARCHAR(255) DEFAULT NULL,                    
                          `spec15` VARCHAR(255) DEFAULT NULL,                    
                          `spec16` VARCHAR(255) DEFAULT NULL,                    
                          `spec17` VARCHAR(255) DEFAULT NULL,                    
                          `spec18` VARCHAR(255) DEFAULT NULL,                    
                          `spec19` VARCHAR(255) DEFAULT NULL,                    
                          `spec20` VARCHAR(255) DEFAULT NULL,                    
                          `spec21` VARCHAR(255) DEFAULT NULL,                    
                          `spec22` VARCHAR(255) DEFAULT NULL,                    
                          `spec23` VARCHAR(255) DEFAULT NULL,                    
                          `spec24` VARCHAR(255) DEFAULT NULL,                    
                          `spec25` VARCHAR(255) DEFAULT NULL,                    
                          `url` VARCHAR(255) DEFAULT NULL,                       
                          PRIMARY KEY (`id`)                                     
                        ) ;
ALTER TABLE `t_vendor_product_import_log` CHANGE `group_id` `group_id` VARCHAR (255)  NULL 
ALTER TABLE `m_vendor_api_info` ADD COLUMN `default_brand` VARCHAR (255)  NULL  AFTER `vendor_id`, ADD COLUMN `default_menu` VARCHAR (255)  NULL  AFTER `default_brand`;                        
#==============================================================
# Apr_25_2014
ALTER TABLE `king_transactions` ADD COLUMN `pnh_member_fee` DOUBLE DEFAULT 0 NULL AFTER `order_for`;
#======================================================
##Apr_25_4_2014
#Update Member fee column in transacctions table
UPDATE king_transactions tr 
JOIN pnh_member_offers mo ON mo.transid_ref = tr.transid
SET tr.pnh_member_fee = 50
WHERE tr.order_for != 2
#================================================
##Apr_28_2014
ALTER TABLE t_stock_info ADD COLUMN expiry_on DATE AFTER mrp,ADD COLUMN offer_note DATE AFTER expiry_on;
ALTER TABLE m_product_info ADD COLUMN self_life INT DEFAULT NULL AFTER product_cat_id; 
#============================================
#May_01_2014
ALTER TABLE `pnh_member_offers` ADD COLUMN `mob_serv_provider` VARCHAR (50)  NULL  AFTER `remarks`;
#============================================
# May_04_2014
ALTER TABLE m_rack_bin_info ADD COLUMN is_damaged TINYINT(1) DEFAULT 0 AFTER bin_name;
#===============================================
# May_05_2014
ALTER TABLE m_storage_location_info DROP COLUMN is_damaged;
#===============================================
#May_06_2014
ALTER TABLE `pnh_member_offers` DROP COLUMN `mob_serv_provider`;
ALTER TABLE `pnh_member_info` ADD COLUMN `mobile_network` VARCHAR(100) NULL AFTER `mobile`; 
#==========================
ALTER TABLE t_vendor_po_order_link ADD COLUMN order_status TINYINT(1) DEFAULT 0 AFTER order_qty; 
ALTER TABLE m_vendor_product_link ADD COLUMN `ven_stock_qty` INT(5) DEFAULT '0' AFTER is_active;

CREATE TABLE `disabled_batch_log` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `transid` VARCHAR(255) DEFAULT NULL,
  `remarks` TINYTEXT,
  `status` TINYINT(11) NOT NULL DEFAULT '1',
  `created_on` DATETIME DEFAULT NULL,
  `created_by` INT(11) DEFAULT NULL,
  `modified_on` DATETIME DEFAULT NULL,
  `modified_by` INT(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
); 
#========================================================================
#May_12_2014
ALTER TABLE `pnh_member_offers` ADD COLUMN `details_updated` TINYINT(11) DEFAULT 0 NULL AFTER `delivery_status`; 
#==========================================================================================================
#Update details_updated for insurance offers
UPDATE pnh_member_offers mo
JOIN pnh_member_info minfo ON minfo.pnh_member_id = mo.member_id
JOIN pnh_member_insurance mi ON mi.sno = mo.insurance_id
 SET details_updated = 1
WHERE mo.offer_type IN (0,2) AND minfo.mobile!='' AND mi.proof_id!='' AND mi.proof_type!='' AND mi.proof_address!='' AND mi.first_name!='' AND mi.mob_no!='' AND mi.mem_receipt_no!='' AND UNIX_TIMESTAMP(mi.mem_receipt_date)!='' AND mi.mem_receipt_amount!='';
#==========================================================================================================
#Update details_updated for recharge offers
UPDATE pnh_member_offers mo 
JOIN pnh_member_info minfo ON minfo.pnh_member_id = mo.member_id
SET details_updated = 1
WHERE mo.offer_type=1 AND minfo.mobile_network!='' AND minfo.first_name!='' AND minfo.mobile!='';
#==========================================================================================================
# May_14_2014
ALTER TABLE `king_orders` ADD COLUMN `order_product_id` BIGINT NULL AFTER `lpoints_valid_days`;

#BIG BUCKET ROW
#INSERT INTO `shipment_batch_process` (`num_orders`, `status`, `batch_remarks`,`orders_by`, `created_by`,`created_on`) VALUES ('9999', '2', 'DEFAULT BIG BUCKET - RESERVATION','Developer', '0','2013-10-03 14:42:46');
#=====================================================================================
#May_15_2014
ALTER TABLE king_orders CHANGE order_product_id order_product_id INT(11) DEFAULT 0 ;
ALTER TABLE king_dealitems CHANGE is_group is_group TINYINT(1) DEFAULT 0;
#================================================================================
#May_17_2014
RENAME TABLE `pnh_api_user_auth` TO `pnh_user_auth`;
RENAME TABLE `pnh_api_users` TO `pnh_users`; 
#=============================================================
#May_20_2014
CREATE TABLE `t_vendor_product_import_counts` (  
                                  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,       
                                  `vendor_id` BIGINT(20) DEFAULT NULL,           
                                  `file_name` VARCHAR(255) DEFAULT NULL,         
                                  `total_products` INT(10) DEFAULT NULL,         
                                  `total_deals` INT(10) DEFAULT NULL,            
                                  `total_deals_inserted` INT(10) DEFAULT NULL,   
                                  `total_error_flaged` INT(10) DEFAULT NULL,     
                                  `created_on` DATETIME DEFAULT NULL,            
                                  PRIMARY KEY (`id`)                             
                                );
#===============< REQUEST & complaint TABLE >====================
#May_21_2014
CREATE TABLE `pnh_franchise_requests`( `id` BIGINT NOT NULL AUTO_INCREMENT, `franchise_id` VARCHAR(100), `request_from` VARCHAR(80), `request_desc` TEXT, `status` TINYINT(11), `created_on` DATETIME, PRIMARY KEY (`id`) );
CREATE TABLE `pnh_franchise_complaints`( `id` BIGINT NOT NULL AUTO_INCREMENT, `token_id` VARCHAR(180) COMMENT 'Complaint Reference id', `franchise_id` INT(50), `complaint_from` VARCHAR(80), `complaint_desc` TEXT, `priority` VARCHAR(50), `remarks` VARCHAR(100), `status` TINYINT(11) DEFAULT 1, `created_on` DATETIME, PRIMARY KEY (`id`) );
#===============< REQUEST & complaint TABLE >====================
#May_27_2014
ALTER TABLE `pnh_member_insurance` ADD COLUMN `processed_by` TINYINT(20) NULL AFTER `modified_on`, ADD COLUMN `processed_on` DATETIME NULL AFTER `processed_by`;
# ==========================================
# May_28_2014
ALTER TABLE `pnh_member_insurance_printlog` ADD COLUMN `status` TINYINT(11) DEFAULT 1 NULL AFTER `last_printed_on`; 
# ==========================================
#May_29_2014 - INDEX UPDATES
ALTER TABLE `t_imei_no` ADD INDEX `imei_no` (`imei_no`), ADD INDEX `status` (`status`);
ALTER TABLE `pnh_member_fee` ADD INDEX `indexes` (`member_id`, `transid`, `invoice_no`); 
ALTER TABLE `pnh_member_insurance_printlog` ADD INDEX `indexes` (`insurance_id`, `printed_by`); 
ALTER TABLE `pnh_member_offers` ADD INDEX `Indexes` (`member_id`, `franchise_id`, `offer_type`, `pnh_pid`, `transid_ref`, `insurance_id`, `process_status`); 
ALTER TABLE `pnh_member_offers_log` ADD INDEX `Indexes` (`fid`, `mid`, `offer_type`, `status`); 
ALTER TABLE `pnh_member_offers` DROP INDEX `member_id`, DROP INDEX `franchise_id`, DROP INDEX `transid_ref`, DROP INDEX `order_id`, DROP INDEX `insurance_id`, DROP INDEX `member_id_2`;
ALTER TABLE `pnh_member_insurance` DROP INDEX `fid_2`; 
ALTER TABLE `pnh_member_insurance_menu` DROP INDEX `menu_id_2`; 
ALTER TABLE `pnh_t_receipt_reconcilation` ADD INDEX `Indexes` (`debit_note_id`, `invoice_no`, `dispatch_id`, `inv_amount`, `unreconciled`, `is_invoice_cancelled`);
ALTER TABLE `pnh_t_receipt_reconcilation_log` ADD INDEX `Indexes` (`credit_note_id`, `receipt_id`, `reconcile_id`, `is_invoice_cancelled`, `is_reversed`); 
ALTER TABLE `non_sk_imei_insurance_orders` ADD INDEX (`franchise_id`, `order_id`, `transid`, `userid`, `member_id`, `nonsk_imei_no`, `model_no`, `insurance_id`);
ALTER TABLE `pnh_member_fee` DROP INDEX `indexes`, ADD INDEX (`member_id`), ADD INDEX (`transid`), ADD INDEX (`invoice_no`), ADD INDEX (`status`);
ALTER TABLE `pnh_member_insurance` DROP INDEX `fid`, ADD INDEX (`fid`), ADD INDEX (`mid`), ADD INDEX (`menu_log_id`), ADD INDEX (`offer_type`), ADD INDEX (`proof_id`), ADD INDEX (`opted_insurance`), ADD INDEX (`offer_status`), ADD INDEX (`insurance_margin`), ADD INDEX (`itemid`), ADD INDEX (`order_id`), ADD INDEX (`mob_no`);
ALTER TABLE `pnh_member_insurance_menu` DROP INDEX `menu_id`, ADD INDEX (`menu_id`), ADD INDEX (`greater_than`), ADD INDEX (`less_than`), ADD INDEX (`insurance_margin`), ADD INDEX (`is_active`);
ALTER TABLE `pnh_member_insurance_printlog` DROP INDEX `indexes`, ADD INDEX (`insurance_id`), ADD INDEX (`printcount`), ADD INDEX (`printed_by`);
ALTER TABLE `pnh_member_offers` DROP INDEX `Indexes`, ADD INDEX (`member_id`), ADD INDEX (`franchise_id`), ADD INDEX (`offer_type`), ADD INDEX (`mem_fee_applicable`), ADD INDEX (`pnh_member_fee`), ADD INDEX (`pnh_pid`), ADD INDEX (`order_id`), ADD INDEX (`transid_ref`), ADD INDEX (`insurance_id`), ADD INDEX (`process_status`), ADD INDEX (`feedback_status`), ADD INDEX (`delivery_status`), ADD INDEX (`details_updated`); 
ALTER TABLE `pnh_member_offers_log` DROP INDEX `Indexes`, ADD INDEX (`fid`), ADD INDEX (`mid`), ADD INDEX (`offer_type`), ADD INDEX (`status`); 
ALTER TABLE `pnh_t_receipt_reconcilation` DROP INDEX `Indexes`, ADD INDEX (`debit_note_id`), ADD INDEX (`invoice_no`), ADD INDEX (`dispatch_id`), ADD INDEX (`inv_amount`), ADD INDEX (`unreconciled`), ADD INDEX (`is_invoice_cancelled`);
ALTER TABLE `pnh_t_receipt_reconcilation_log` DROP INDEX `Indexes`, ADD INDEX (`credit_note_id`), ADD INDEX (`receipt_id`), ADD INDEX (`reconcile_id`), ADD INDEX (`is_invoice_cancelled`), ADD INDEX (`is_reversed`);
ALTER TABLE `non_sk_imei_insurance_orders` DROP INDEX `franchise_id`, ADD INDEX (`franchise_id`), ADD INDEX (`order_id`), ADD INDEX (`transid`), ADD INDEX (`userid`), ADD INDEX (`member_id`), ADD INDEX (`nonsk_imei_no`), ADD INDEX (`model_no`), ADD INDEX (`insurance_id`);
# =========================================
#May_29_2014 - table removed
DROP TABLE `nonskimei_mem_fee_insu_amt`;
# =========================================
 # May_30_2014
ALTER TABLE `pnh_member_offers_log` ADD COLUMN `offer_sno` BIGINT(20) NULL COMMENT 'manage offers sno' AFTER `sno`;
#==========================================
#May_28_2014
ALTER TABLE `m_vendor_product_link` ADD COLUMN `vendor_group_no` INT (11)  NULL  AFTER `vendor_id`;
#================================================================================
#Jun_05_2014
CREATE TABLE `m_employee_dept_link`( `id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT, `employee_id` INT(150), `dept_id` INT(150), `is_active` TINYINT(11), `created_on` DATETIME, `created_by` INT(50), `modified_on` DATETIME, `modified_by` INT(50), PRIMARY KEY (`id`) );
CREATE TABLE `m_departments`( `id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT, `name` VARCHAR(150), `keyword` VARCHAR(100), `created_on` DATETIME, `created_by` INT(50), `modified_on` DATETIME, `modified_by` INT(50), `status` TINYINT(11), PRIMARY KEY (`id`) );

INSERT INTO `m_departments` (`name`, `keyword`, `created_on`, `created_by`,`status`) VALUES ('Customer Support', 'CUSP', '2014-06-05 13:21:48', '1', '1'); 
INSERT INTO `m_departments` (`name`, `keyword`, `created_on`, `created_by`,`status`) VALUES ('Account and Finance', 'AF', '2014-06-05 13:22:16', '1', '1'); 
INSERT INTO `m_departments` (`name`, `keyword`, `created_on`, `created_by`,`status`) VALUES ('Sourcing', 'SRC', '2014-06-05 13:24:58', '1', '1'); 
INSERT INTO `m_departments` (`name`, `keyword`, `created_on`, `created_by`,`status`) VALUES ('Logistics', 'LOG', '2014-06-05 13:21:48', '1', '1');

ALTER TABLE `m_employee_roles` ADD COLUMN `status` TINYINT(11) DEFAULT 1 NULL AFTER `created_by`;
INSERT INTO `m_employee_roles` (`role_name`, `short_frm`, `created_on`, `created_by`,`status`) VALUES ('Office Emplolyee', 'OFFICE_EMP', '2014-06-03 18:47:03', '54', '0');
ALTER TABLE `m_employee_info` ADD COLUMN `emp_type` TINYINT(11) DEFAULT 2 NULL COMMENT '1:field emp,2:office emp' AFTER `remarks`;
#================================================================================
#Jun_06_2014
ALTER TABLE `pnh_franchise_requests` CHANGE `request_from` `from` VARCHAR(80) CHARSET latin1 COLLATE latin1_swedish_ci DEFAULT 'app' NULL, ADD COLUMN `type` VARCHAR(50) NULL AFTER `from`, CHANGE `request_desc` `title` VARCHAR(150) CHARSET latin1 COLLATE latin1_swedish_ci NULL, CHANGE `status` `desc` TEXT NULL, CHANGE `created_on` `status` TINYINT(11) DEFAULT 1 NULL COMMENT '1:pending,2:done,3:cancelled', ADD COLUMN `created_on` DATETIME NULL AFTER `status`, ADD COLUMN `modified_on` DATETIME NULL AFTER `created_on`, ADD COLUMN `modified_by` INT(20) NULL AFTER `modified_on`;
#================================================================================
#May_28_2014
ALTER TABLE `m_vendor_product_link` ADD COLUMN `vendor_group_no` INT (11)  NULL  AFTER `vendor_id`;
#================================================================================
#june_9_2014
CREATE TABLE `m_vendor_api_datalog` (                     
                        `id` BIGINT(20) NOT NULL AUTO_INCREMENT,                
                        `batch_id` INT(11) DEFAULT '0',                         
                        `vendor_id` INT(11) DEFAULT '0',                        
                        `resource_id` INT(11) DEFAULT '0',                      
                        `product_name` VARCHAR(255) DEFAULT NULL,               
                        `sku_code` VARCHAR(255) DEFAULT NULL,                   
                        `product_code` VARCHAR(255) DEFAULT NULL,               
                        `model_code` VARCHAR(255) DEFAULT NULL,                 
                        `qty` VARCHAR(255) DEFAULT NULL,                        
                        `short_description` VARCHAR(255) DEFAULT NULL,          
                        `category` VARCHAR(255) DEFAULT NULL,                   
                        `category1` VARCHAR(255) DEFAULT NULL,                  
                        `category2` VARCHAR(255) DEFAULT NULL,                  
                        `category3` VARCHAR(255) DEFAULT NULL,                  
                        `category4` VARCHAR(255) DEFAULT NULL,                  
                        `brand` VARCHAR(255) DEFAULT NULL,                      
                        `menu` VARCHAR(255) DEFAULT NULL,                       
                        `unit_of_measurement` VARCHAR(255) DEFAULT NULL,        
                        `mrp` VARCHAR(255) DEFAULT NULL,                        
                        `offer_price` VARCHAR(255) DEFAULT NULL,                
                        `vat` VARCHAR(255) DEFAULT NULL,                        
                        `purchase_cost` VARCHAR(255) DEFAULT NULL,              
                        `barcode` VARCHAR(255) DEFAULT NULL,                    
                        `group_id` VARCHAR(255) DEFAULT NULL,                   
                        `gender_attr` VARCHAR(255) DEFAULT NULL,                
                        `long_description` VARCHAR(255) DEFAULT NULL,           
                        `main_image` VARCHAR(255) DEFAULT NULL,                 
                        `image1` VARCHAR(255) DEFAULT NULL,                     
                        `image2` VARCHAR(255) DEFAULT NULL,                     
                        `image3` VARCHAR(255) DEFAULT NULL,                     
                        `image4` VARCHAR(255) DEFAULT NULL,                     
                        `image5` VARCHAR(255) DEFAULT NULL,                     
                        `color` VARCHAR(255) DEFAULT NULL,                      
                        `size` VARCHAR(255) DEFAULT NULL,                       
                        `attr1` VARCHAR(255) DEFAULT NULL,                      
                        `attr2` VARCHAR(255) DEFAULT NULL,                      
                        `spec1` VARCHAR(255) DEFAULT NULL,                      
                        `spec2` VARCHAR(255) DEFAULT NULL,                      
                        `spec3` VARCHAR(255) DEFAULT NULL,                      
                        `spec4` VARCHAR(255) DEFAULT NULL,                      
                        `spec5` VARCHAR(255) DEFAULT NULL,                      
                        `spec6` VARCHAR(255) DEFAULT NULL,                      
                        `spec7` VARCHAR(255) DEFAULT NULL,                      
                        `spec8` VARCHAR(255) DEFAULT NULL,                      
                        `spec9` VARCHAR(255) DEFAULT NULL,                      
                        `spec10` VARCHAR(255) DEFAULT NULL,                     
                        `spec11` VARCHAR(255) DEFAULT NULL,                     
                        `spec12` VARCHAR(255) DEFAULT NULL,                     
                        `spec13` VARCHAR(255) DEFAULT NULL,                     
                        `spec14` VARCHAR(255) DEFAULT NULL,                     
                        `spec15` VARCHAR(255) DEFAULT NULL,                     
                        `spec16` VARCHAR(255) DEFAULT NULL,                     
                        `spec17` VARCHAR(255) DEFAULT NULL,                     
                        `spec18` VARCHAR(255) DEFAULT NULL,                     
                        `spec19` VARCHAR(255) DEFAULT NULL,                     
                        `spec20` VARCHAR(255) DEFAULT NULL,                     
                        `spec21` VARCHAR(255) DEFAULT NULL,                     
                        `spec22` VARCHAR(255) DEFAULT NULL,                     
                        `spec23` VARCHAR(255) DEFAULT NULL,                     
                        `spec24` VARCHAR(255) DEFAULT NULL,                     
                        `spec25` VARCHAR(255) DEFAULT NULL,                     
                        `url` VARCHAR(255) DEFAULT NULL,                        
                        `expected_dod` VARCHAR(255) DEFAULT NULL,               
                        `import_filename` VARCHAR(255) DEFAULT NULL,            
                        `imported_on` DATETIME DEFAULT NULL,                    
                        `import_status` INT(1) DEFAULT '0',                     
                        `created_on` DATETIME DEFAULT NULL,                     
                        `modified_on` DATETIME DEFAULT NULL,                    
                        PRIMARY KEY (`id`)                                      
                      );
#================================================================================
#Jun_09_2014
INSERT INTO `m_departments` (`name`, `keyword`,`created_on`,`created_by`, `status` ) VALUES ('Techical', 'TECH','2014-06-09 17:12:32' ,'1' ,'1');
#RENAME TABLE `m_dept_ request_types` TO `m_dept_request_types`;
CREATE TABLE `m_dept_request_types`( `id` INT(250) UNSIGNED NOT NULL AUTO_INCREMENT, `name` VARCHAR(200), PRIMARY KEY (`id`) );
INSERT INTO `m_dept_request_types` (`name`) VALUES ('Product'); 
INSERT INTO `m_dept_request_types` (`name`) VALUES ('Payment'); 
INSERT INTO `m_dept_request_types` (`name`) VALUES ('Service');
INSERT INTO `m_dept_request_types` (`name`) VALUES ('Insurance');
INSERT INTO `m_dept_request_types` (`name`) VALUES ('Shipment');
INSERT INTO `m_dept_request_types` (`name`) VALUES ('Technical');
CREATE TABLE `m_dept_request_type_link`( `id` BIGINT NOT NULL AUTO_INCREMENT, `dept_id` BIGINT, `type_id` BIGINT COMMENT 'request_type table id', `is_active` TINYINT(11) DEFAULT 1, `created_on` DATETIME, `created_by` INT(80), `modified_on` DATETIME, `modified_by` INT(80), PRIMARY KEY (`id`) );

INSERT INTO `m_dept_request_type_link` (`dept_id`, `type_id`, `created_on`, `created_by`) VALUES ('1', '1', '2014-06-09 19:27:30', '1'); 
INSERT INTO `m_dept_request_type_link` (`dept_id`, `type_id`, `created_on`, `created_by`) VALUES ('2', '2', '2014-06-09 19:27:51', '1'); 
INSERT INTO `m_dept_request_type_link` (`dept_id`, `type_id`, `created_on`, `created_by`) VALUES ('3', '3', '2014-06-09 19:28:06', '1'); 
INSERT INTO `m_dept_request_type_link` (`dept_id`, `type_id`, `created_on`, `created_by`) VALUES ('4', '4', '2014-06-09 19:28:29', '1'); 
INSERT INTO `m_dept_request_type_link` (`dept_id`, `type_id`, `created_on`, `created_by`) VALUES ('5', '5', '2014-06-09 19:28:45', '1');
INSERT INTO `m_dept_request_type_link` (`dept_id`, `type_id`, `created_on`, `created_by`) VALUES ('4', '5', '2014-06-09 19:31:32', '1');
#Jun_10_2014
ALTER TABLE `support_tickets` ADD COLUMN `franchise_id` BIGINT NULL AFTER `updated_on`, ADD COLUMN `related_to` INT(100) NULL AFTER `franchise_id`; 
#====================================================================
#Jun_11_2014
CREATE TABLE `pnh_t_returns_transit_log` (
`id` BIGINT(11) NOT NULL AUTO_INCREMENT,
`order_id` BIGINT(15) DEFAULT NULL,
`return_id` BIGINT(11) DEFAULT NULL,
`ticket_id` BIGINT(11) DEFAULT NULL,
`transit_mode` TINYINT(1) DEFAULT '0',
`courier` VARCHAR(255) DEFAULT NULL,
`awb` VARCHAR(255) DEFAULT NULL,
`emp_phno` INT(11) DEFAULT '0',
`emp` INT(255) DEFAULT NULL,
`status` TINYINT(1) DEFAULT '0',
`logged_on` BIGINT(25) DEFAULT NULL,
`logged_by` TINYINT(1) DEFAULT NULL,
`returned_on` BIGINT(25) DEFAULT NULL,
`returned_by` TINYINT(1) DEFAULT '0',
PRIMARY KEY (`id`)
);

ALTER TABLE `pnh_t_returns_transit_log` CHANGE `emp_phno` `emp_phno` INT(11) DEFAULT 0 NULL; 

ALTER TABLE `pnh_invoice_returns` ADD COLUMN `transit_type` TINYINT(1) DEFAULT 0 NOT NULL AFTER `returned_on`; 

ALTER TABLE `pnh_t_returns_transit_log` CHANGE `courier_id` `courier` VARCHAR(255) NULL; 

ALTER TABLE `pnh_t_receipt_info` ADD COLUMN `courier_name` VARCHAR(255) NULL AFTER `unreconciled_status`, ADD COLUMN `awb` VARCHAR(255) NULL AFTER `courier_name`, ADD COLUMN `emp_name` VARCHAR(255) NULL AFTER `awb`, ADD COLUMN `contact_no` INT(11) NULL AFTER `emp_name`; 
#====================================================================
#Jun_12_2014
ALTER TABLE `pnh_member_insurance` ADD INDEX (`status_ship`);
#====================================================================

#===============MEMBER PRICE DB CHANGES==========================================
#Jun_13_2014
ALTER TABLE `pnh_m_franchise_info` ADD COLUMN `price_type` TINYINT(1) DEFAULT 0 NULL AFTER `new_credit_limit`; 
ALTER TABLE `king_orders` ADD COLUMN `member_price` DOUBLE DEFAULT 0 NULL AFTER `redeem_value`, ADD COLUMN `is_memberprice` TINYINT(1) DEFAULT 0 NULL AFTER `partner_order_id`; 
ALTER TABLE `king_dealitems` ADD COLUMN `member_price` INT(10) UNSIGNED DEFAULT 0 NOT NULL AFTER `price`; 
CREATE TABLE `franchise_pricetype_log`( `id` INT(11) NOT NULL AUTO_INCREMENT, `franchise_id` BIGINT(11), `price_type` TINYINT(1), `modified_on` BIGINT(25), `modified_by` INT(11), PRIMARY KEY (`id`) ); 
ALTER TABLE `franchise_pricetype_log` ADD COLUMN `reason` VARCHAR(255) NULL AFTER `price_type`; 
ALTER TABLE `pnh_sch_discount_brands` ADD COLUMN `price_type` TINYINT(1) DEFAULT 0 NOT NULL AFTER `is_sch_enabled`; 
#====================================================================
#Jun_14_2014
ALTER TABLE `king_orders` ADD COLUMN `other_price` DOUBLE DEFAULT 0 NULL AFTER `member_price`;
#===============MEMBER PRICE DB CHANGES==========================================
#Jun_17_2014
ALTER TABLE `deal_price_changelog` ADD COLUMN `old_member_price` DECIMAL(10,2) NULL AFTER `old_price`, ADD COLUMN `new_member_price` DECIMAL(10,2) NULL AFTER `old_member_price`;
ALTER TABLE `king_dealitems` CHANGE `member_price` `member_price` DECIMAL(10,2) UNSIGNED DEFAULT 0 NOT NULL, ADD COLUMN `mp_max_qty` INT(10) NULL AFTER `member_price`, ADD COLUMN `mp_max_order_qty` INT(10) DEFAULT 0 NULL AFTER `mp_max_qty`;
CREATE TABLE `deal_member_price_changelog` (
  `id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT,
  `itemid` BIGINT(20) UNSIGNED NOT NULL,
  `old_member_price` DECIMAL(10,2) DEFAULT NULL,
  `new_member_price` DECIMAL(10,2) DEFAULT NULL,
  `new_mp_max_qty`INT(10) UNSIGNED NOT NULL,
  `old_mp_max_qty`INT(10) UNSIGNED NOT NULL,
  `new_mp_max_order_qty` INT(10) UNSIGNED NOT NULL,
  `old_mp_max_order_qty`INT(10) UNSIGNED NOT NULL,
  `created_by` INT(10) UNSIGNED NOT NULL,
  `created_on` DATETIME DEFAULT NULL,
  `is_active` TINYINT(1) NOT NULL DEFAULT 1,
  PRIMARY KEY (`id`),
  KEY `itemid` (`itemid`)
);
#=============================== 
CREATE TABLE `pnh_t_returns_transit_log` (
  `id` BIGINT(11) NOT NULL AUTO_INCREMENT,
  `order_id` BIGINT(15) DEFAULT NULL,
  `return_id` BIGINT(11) DEFAULT NULL,
  `ticket_id` BIGINT(11) DEFAULT NULL,
  `transit_mode` TINYINT(1) DEFAULT '0',
  `courier` VARCHAR(255) DEFAULT NULL,
  `awb` VARCHAR(255) DEFAULT NULL,
  `emp_phno` INT(11) DEFAULT '0',
  `emp` INT(255) DEFAULT NULL,
  `status` TINYINT(1) DEFAULT '0',
  `logged_on` BIGINT(25) DEFAULT NULL,
  `logged_by` TINYINT(1) DEFAULT NULL,
  `returned_on` BIGINT(25) DEFAULT NULL,
  `returned_by` TINYINT(1) DEFAULT '0',
  PRIMARY KEY (`id`)
);

#===============================================
ALTER TABLE `m_vendor_api_templates` ADD COLUMN `attr3` VARCHAR (255)  NULL  AFTER `attr2`, ADD COLUMN `attr4` VARCHAR (255)  NULL  AFTER `attr3`, ADD COLUMN `attr5` VARCHAR (255)  NULL  AFTER `attr4`, ADD COLUMN `attr6` VARCHAR (255)  NULL  AFTER `attr5`, ADD COLUMN `attr7` VARCHAR (255)  NULL  AFTER `attr6`, ADD COLUMN `attr8` VARCHAR (255)  NULL  AFTER `attr7`,CHANGE `purchase_cost` `purchase_cost` VARCHAR (255)  NULL  COLLATE latin1_swedish_ci; 
ALTER TABLE `m_vendor_api_datalog` ADD COLUMN `attr3` VARCHAR (255)  NULL  AFTER `attr2`, ADD COLUMN `attr4` VARCHAR (255)  NULL  AFTER `attr3`, ADD COLUMN `attr5` VARCHAR (255)  NULL  AFTER `attr4`, ADD COLUMN `attr6` VARCHAR (255)  NULL  AFTER `attr5`, ADD COLUMN `attr7` VARCHAR (255)  NULL  AFTER `attr6`, ADD COLUMN `attr8` VARCHAR (255)  NULL  AFTER `attr7`,CHANGE `purchase_cost` `purchase_cost` VARCHAR (255)  NULL  COLLATE latin1_swedish_ci;

CREATE TABLE `m_vendor_attributes_link` (                                                   
                            `id` BIGINT(20) NOT NULL AUTO_INCREMENT,                                                  
                            `vendor_id` INT(11) DEFAULT NULL,                                                         
                            `attr` VARCHAR(255) DEFAULT NULL COMMENT 'vendor template link table attributes names ',  
                            `attr_id` INT(11) DEFAULT NULL COMMENT 'master attribute table attrbute ids',             
                            `created_on` DATETIME DEFAULT NULL,                                                       
                            `created_by` INT(11) DEFAULT NULL,                                                        
                            PRIMARY KEY (`id`)                                                                        
                          );
#=============================================================
#Jun_23_2014
ALTER TABLE `deal_member_price_changelog` ADD COLUMN `mp_is_offer` TINYINT(11) DEFAULT 0 NULL AFTER `old_mp_max_order_qty`, ADD COLUMN `mp_offer_from` DATETIME NULL AFTER `mp_is_offer`, ADD COLUMN `mp_offer_to` DATETIME NULL AFTER `mp_offer_from`; 
ALTER TABLE `king_dealitems` ADD COLUMN `mp_is_offer` TINYINT(11) NULL AFTER `mp_max_order_qty`, ADD COLUMN `mp_offer_from` DATETIME NULL AFTER `mp_is_offer`, ADD COLUMN `mp_offer_to` DATETIME NULL AFTER `mp_offer_from`; 
# API changes-Franchise/API admin user created
INSERT INTO `king_admin` (`user_id`, `name`, `username`, `password`, `usertype`, `access`, `brandid`, `fullname`, `email`, `createdon`, `modifiedon`) VALUES ('0ec7bd10ef5d2c99e7121241f8f12d1f', 'Franchise/API', 'franchise', 'dc21afd02d0c2edb2bee3ead8da23e1f', '1', '0', '0', '', 'franchise@storeking.in', '2014-06-23 18:19:21', '2014-06-23 18:19:23'); 
#=============================================================

#jun_24 2014
#=============================== 
ALTER TABLE `shipment_batch_process_invoice_link` CHANGE `is_delivered` `is_delivered` INT (11)  NOT NULL;

ALTER TABLE `m_employee_roles` CHANGE `status` `emp_role_status` TINYINT(11) DEFAULT 1 NULL;
#===========================================
# Jun_25_2014
ALTER TABLE `king_dealitems` ADD COLUMN `mp_offer_note` TEXT NULL AFTER `mp_offer_to`;
ALTER TABLE `deal_member_price_changelog` ADD COLUMN `mp_offer_note` TEXT NULL AFTER `mp_offer_to`;
ALTER TABLE `deal_member_price_changelog` CHANGE `is_active` `is_active` TINYINT(1) DEFAULT 1 NOT NULL AFTER `mp_offer_note`, ADD COLUMN `modified_on` DATETIME NULL AFTER `created_on`, ADD COLUMN `modified_by` INT(10) NULL AFTER `modified_on`;
# Jun_26_2014
ALTER TABLE `deal_member_price_changelog` CHANGE `new_mp_max_qty` `new_mp_max_qty` INT(10) UNSIGNED DEFAULT 0 NOT NULL, CHANGE `old_mp_max_qty` `old_mp_max_qty` INT(10) UNSIGNED DEFAULT 0 NOT NULL, CHANGE `new_mp_max_order_qty` `new_mp_max_order_qty` INT(10) UNSIGNED DEFAULT 0 NOT NULL, CHANGE `old_mp_max_order_qty` `old_mp_max_order_qty` INT(10) UNSIGNED DEFAULT 0 NOT NULL;
#===========================================
#Jun_26_2014
ALTER TABLE `king_dealitems` CHANGE `mp_max_qty` `mp_frn_max_qty` INT(10) DEFAULT 0 NULL, CHANGE `mp_max_order_qty` `mp_mem_max_qty` INT(10) DEFAULT 0 NULL;
ALTER TABLE `deal_member_price_changelog` CHANGE `new_mp_max_qty` `new_mp_frn_max_qty` INT(10) UNSIGNED DEFAULT 0 NOT NULL, CHANGE `old_mp_max_qty` `old_mp_frn_max_qty` INT(10) UNSIGNED DEFAULT 0 NOT NULL, CHANGE `new_mp_max_order_qty` `new_mp_mem_max_qty` INT(10) UNSIGNED DEFAULT 0 NOT NULL, CHANGE `old_mp_max_order_qty` `old_mp_mem_max_qty` INT(10) UNSIGNED DEFAULT 0 NOT NULL;
ALTER TABLE `king_dealitems` CHANGE `mp_frn_max_qty` `mp_frn_max_qty` INT(10) DEFAULT 0 NOT NULL;
#===========================================

#===============================================
ALTER TABLE `m_client_category_link` ADD COLUMN `main_category` VARCHAR (255)  NULL  AFTER `client_category`;
ALTER TABLE `m_vendor_api_templates` ADD COLUMN `spec26` VARCHAR (255)  NULL  AFTER `spec25`, ADD COLUMN `spec27` VARCHAR (255)  NULL  AFTER `spec26`, ADD COLUMN `spec28` VARCHAR (255)  NULL  AFTER `spec27`, ADD COLUMN `spec29` VARCHAR (255)  NULL  AFTER `spec28`, ADD COLUMN `spec30` VARCHAR (255)  NULL  AFTER `spec29`, ADD COLUMN `spec31` VARCHAR (255)  NULL  AFTER `spec30`, ADD COLUMN `spec32` VARCHAR (255)  NULL  AFTER `spec31`, ADD COLUMN `spec33` VARCHAR (255)  NULL  AFTER `spec32`, ADD COLUMN `spec34` VARCHAR (255)  NULL  AFTER `spec33`, ADD COLUMN `spec35` VARCHAR (255)  NULL  AFTER `spec34`, ADD COLUMN `spec36` VARCHAR (255)  NULL  AFTER `spec35`, ADD COLUMN `spec37` VARCHAR (255)  NULL  AFTER `spec36`, ADD COLUMN `spec38` VARCHAR (255)  NULL  AFTER `spec37`, ADD COLUMN `spec39` VARCHAR (255)  NULL  AFTER `spec38`, ADD COLUMN `spec40` VARCHAR (255)  NULL  AFTER `spec39`, ADD COLUMN `spec41` VARCHAR (255)  NULL  AFTER `spec40`, ADD COLUMN `spec42` VARCHAR (255)  NULL  AFTER `spec41`, ADD COLUMN `spec43` VARCHAR (255)  NULL  AFTER `spec42`, ADD COLUMN `spec44` VARCHAR (255)  NULL  AFTER `spec43`, ADD COLUMN `spec45` VARCHAR (255)  NULL  AFTER `spec44`, ADD COLUMN `spec46` VARCHAR (255)  NULL  AFTER `spec45`, ADD COLUMN `spec47` VARCHAR (255)  NULL  AFTER `spec46`, ADD COLUMN `spec48` VARCHAR (255)  NULL  AFTER `spec47`, ADD COLUMN `spec49` VARCHAR (255)  NULL  AFTER `spec48`, ADD COLUMN `spec50` VARCHAR (255)  NULL  AFTER `spec49`, ADD COLUMN `spec51` VARCHAR (255)  NULL  AFTER `spec50`, ADD COLUMN `spec52` VARCHAR (255)  NULL  AFTER `spec51`, ADD COLUMN `spec53` VARCHAR (255)  NULL  AFTER `spec52`, ADD COLUMN `spec54` VARCHAR (255)  NULL  AFTER `spec53`, ADD COLUMN `spec55` VARCHAR (255)  NULL  AFTER `spec54`, ADD COLUMN `spec56` VARCHAR (255)  NULL  AFTER `spec55`, ADD COLUMN `spec57` VARCHAR (255)  NULL  AFTER `spec56`, ADD COLUMN `spec58` VARCHAR (255)  NULL  AFTER `spec57`, ADD COLUMN `spec59` VARCHAR (255)  NULL  AFTER `spec58`, ADD COLUMN `spec60` VARCHAR (255)  NULL  AFTER `spec59`,CHANGE `spec25` `spec25` VARCHAR (255)  NULL  COLLATE latin1_swedish_ci;
ALTER TABLE `m_vendor_api_datalog` ADD COLUMN `spec26` VARCHAR (255)  NULL  AFTER `spec25`, ADD COLUMN `spec27` VARCHAR (255)  NULL  AFTER `spec26`, ADD COLUMN `spec28` VARCHAR (255)  NULL  AFTER `spec27`, ADD COLUMN `spec29` VARCHAR (255)  NULL  AFTER `spec28`, ADD COLUMN `spec30` VARCHAR (255)  NULL  AFTER `spec29`, ADD COLUMN `spec31` VARCHAR (255)  NULL  AFTER `spec30`, ADD COLUMN `spec32` VARCHAR (255)  NULL  AFTER `spec31`, ADD COLUMN `spec33` VARCHAR (255)  NULL  AFTER `spec32`, ADD COLUMN `spec34` VARCHAR (255)  NULL  AFTER `spec33`, ADD COLUMN `spec35` VARCHAR (255)  NULL  AFTER `spec34`, ADD COLUMN `spec36` VARCHAR (255)  NULL  AFTER `spec35`, ADD COLUMN `spec37` VARCHAR (255)  NULL  AFTER `spec36`, ADD COLUMN `spec38` VARCHAR (255)  NULL  AFTER `spec37`, ADD COLUMN `spec39` VARCHAR (255)  NULL  AFTER `spec38`, ADD COLUMN `spec40` VARCHAR (255)  NULL  AFTER `spec39`, ADD COLUMN `spec41` VARCHAR (255)  NULL  AFTER `spec40`, ADD COLUMN `spec42` VARCHAR (255)  NULL  AFTER `spec41`, ADD COLUMN `spec43` VARCHAR (255)  NULL  AFTER `spec42`, ADD COLUMN `spec44` VARCHAR (255)  NULL  AFTER `spec43`, ADD COLUMN `spec45` VARCHAR (255)  NULL  AFTER `spec44`, ADD COLUMN `spec46` VARCHAR (255)  NULL  AFTER `spec45`, ADD COLUMN `spec47` VARCHAR (255)  NULL  AFTER `spec46`, ADD COLUMN `spec48` VARCHAR (255)  NULL  AFTER `spec47`, ADD COLUMN `spec49` VARCHAR (255)  NULL  AFTER `spec48`, ADD COLUMN `spec50` VARCHAR (255)  NULL  AFTER `spec49`, ADD COLUMN `spec51` VARCHAR (255)  NULL  AFTER `spec50`, ADD COLUMN `spec52` VARCHAR (255)  NULL  AFTER `spec51`, ADD COLUMN `spec53` VARCHAR (255)  NULL  AFTER `spec52`, ADD COLUMN `spec54` VARCHAR (255)  NULL  AFTER `spec53`, ADD COLUMN `spec55` VARCHAR (255)  NULL  AFTER `spec54`, ADD COLUMN `spec56` VARCHAR (255)  NULL  AFTER `spec55`, ADD COLUMN `spec57` VARCHAR (255)  NULL  AFTER `spec56`, ADD COLUMN `spec58` VARCHAR (255)  NULL  AFTER `spec57`, ADD COLUMN `spec59` VARCHAR (255)  NULL  AFTER `spec58`, ADD COLUMN `spec60` VARCHAR (255)  NULL  AFTER `spec59`,CHANGE `spec25` `spec25` VARCHAR (255)  NULL  COLLATE latin1_swedish_ci;
ALTER TABLE `m_vendor_product_link` CHANGE `vendor_group_no` `vendor_group_no` VARBINARY (255)  NULL ;                           
#Jun_27_2014
ALTER TABLE `king_orders` ADD COLUMN `mp_logid` BIGINT(11) DEFAULT 0 NULL AFTER `is_memberprice`;
#=========================
ALTER TABLE `pnh_menu_margin_track` ADD COLUMN `default_mp_margin` DOUBLE DEFAULT 0 NULL AFTER `default_margin`; 
#=========================
#Jun_28_2014
ALTER TABLE `support_tickets` ADD COLUMN `req_mem_name` VARCHAR(80) NULL AFTER `related_to`, ADD COLUMN `req_mem_mobile` VARCHAR(50) NULL AFTER `req_mem_name`;
#=========================
#Jun_30_2014
ALTER TABLE `king_dealitems` CHANGE `mp_frn_max_qty` `mp_frn_max_qty` INT(10) DEFAULT 1 NOT NULL, CHANGE `mp_mem_max_qty` `mp_mem_max_qty` INT(10) DEFAULT 1 NULL, ADD COLUMN `mp_max_allow_qty` INT(11) DEFAULT 1 NULL AFTER `mp_mem_max_qty`;
ALTER TABLE `deal_member_price_changelog` CHANGE `new_mp_frn_max_qty` `new_mp_frn_max_qty` INT(10) UNSIGNED DEFAULT 1 NOT NULL, CHANGE `old_mp_frn_max_qty` `old_mp_frn_max_qty` INT(10) UNSIGNED DEFAULT 1 NOT NULL, CHANGE `new_mp_mem_max_qty` `new_mp_mem_max_qty` INT(10) UNSIGNED DEFAULT 1 NOT NULL, CHANGE `old_mp_mem_max_qty` `old_mp_mem_max_qty` INT(10) UNSIGNED DEFAULT 1 NOT NULL, ADD COLUMN `mp_max_allow_qty` INT(10) DEFAULT 1 NULL AFTER `old_mp_mem_max_qty`, ADD COLUMN `mp_offer_shipsin` VARCHAR(50) NULL AFTER `mp_offer_note`;
ALTER TABLE `m_product_info` ADD COLUMN `sync_product_src` TINYINT(1) DEFAULT 0 NULL AFTER `corr_updated_on`;
#=========================
#Jul_02_2014
ALTER TABLE `pnh_menu` ADD COLUMN `default_mp_margin` DOUBLE DEFAULT 0 NULL AFTER `default_margin`; 
#=========================
#Jul_03_2014-shivaraj
ALTER TABLE `king_deals` ADD INDEX (`publish`);
ALTER TABLE `deal_member_price_changelog` ADD INDEX (`mp_max_allow_qty`), ADD INDEX (`mp_is_offer`), ADD INDEX (`mp_offer_from`), ADD INDEX (`mp_offer_to`), ADD INDEX (`mp_offer_shipsin`), ADD INDEX (`is_active`);
ALTER TABLE `king_dealitems` ADD INDEX (`member_price`), ADD INDEX (`mp_frn_max_qty`), ADD INDEX (`mp_mem_max_qty`), ADD INDEX (`mp_max_allow_qty`), ADD INDEX (`mp_is_offer`), ADD INDEX (`mp_offer_from`), ADD INDEX (`mp_offer_to`), ADD INDEX (`price`);

# SET EMPTY member price to offer price
UPDATE king_dealitems SET member_price=price,mp_frn_max_qty=1,mp_mem_max_qty=1,mp_max_allow_qty=10 WHERE member_price = '0.00'; #70958 row(s) affected

# INSERT default log entry in log table
INSERT INTO deal_member_price_changelog (itemid,old_member_price,new_member_price,old_mp_frn_max_qty,new_mp_frn_max_qty,old_mp_mem_max_qty,new_mp_mem_max_qty,mp_max_allow_qty,is_active,created_by,created_on)
	( 
		SELECT mi.id,0,mi.member_price,0,mi.mp_frn_max_qty,0,mi.mp_mem_max_qty,mi.mp_max_allow_qty,1 AS is_active,37 AS created_by,NOW()
		FROM king_dealitems AS mi
		LEFT JOIN deal_member_price_changelog mlog ON mlog.itemid = mi.id
		WHERE mlog.itemid IS NULL #AND mi.id='1268616163'
	);
#=========================
#-===Version update log
CREATE TABLE `m_apk_version_update_log` (
  `id` BIGINT(11) NOT NULL AUTO_INCREMENT,
  `franchise_id` INT(11) DEFAULT NULL,
  `menu_id` BIGINT(11) DEFAULT NULL,
  `cat_id` BIGINT(11) DEFAULT NULL,
  `brand_id` BIGINT(11) DEFAULT NULL,
  `updated_version` VARCHAR(255) DEFAULT NULL,
  `updated_on` DATETIME DEFAULT NULL,
  PRIMARY KEY (`id`)
);

ALTER TABLE king_dealitems ADD COLUMN size_chart TEXT DEFAULT "" AFTER price;
#========================================
#Jul_07_2014
ALTER TABLE `king_dealitems` CHANGE mp_offer_note mp_offer_note VARCHAR(2000) DEFAULT '';
ALTER TABLE `deal_member_price_changelog` CHANGE mp_offer_note mp_offer_note VARCHAR(2000) DEFAULT '';

UPDATE deal_member_price_changelog SET mp_offer_note='' WHERE mp_offer_note IS NULL;
UPDATE king_dealitems SET mp_offer_note='' WHERE mp_offer_note IS NULL;
#========================================
#Jul_09_2014 - mp_logid added to dealitems table, 0:mp not set,num:mp log id
ALTER TABLE `king_dealitems` ADD COLUMN `mp_logid` BIGINT(20) DEFAULT 0 NOT NULL AFTER `mp_offer_note`;#71091 rows
#================================================================
#Jul_12_2014
INSERT INTO `m_dept_request_types` (`id`, `name`) VALUES ('7', 'Sourcing');
INSERT INTO `m_dept_request_type_link` (`dept_id`, `type_id`, `created_on`, `created_by`) VALUES ('3', '7', '2014-07-12 19:27:13', '1');
#======================================
#Track SMS orders
CREATE TABLE `king_user_orders` (
  `sno` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT,
  `id` BIGINT(20) UNSIGNED NOT NULL,
  `transid` CHAR(18) NOT NULL,
  `userid` INT(11) UNSIGNED NOT NULL,
  `itemid` BIGINT(20) UNSIGNED NOT NULL,
  `brandid` BIGINT(20) UNSIGNED NOT NULL,
  `vendorid` BIGINT(20) UNSIGNED NOT NULL,
  `bill_person` VARCHAR(100) NOT NULL,
  `bill_address` TEXT NOT NULL,
  `bill_city` TEXT NOT NULL,
  `bill_pincode` VARCHAR(20) NOT NULL,
  `ship_person` VARCHAR(100) NOT NULL,
  `ship_address` TEXT NOT NULL,
  `ship_city` TEXT NOT NULL,
  `ship_pincode` VARCHAR(20) NOT NULL,
  `bill_phone` VARCHAR(50) NOT NULL,
  `ship_phone` VARCHAR(50) NOT NULL,
  `bill_state` VARCHAR(100) NOT NULL,
  `ship_state` VARCHAR(100) NOT NULL,
  `ship_email` VARCHAR(150) NOT NULL,
  `bill_email` VARCHAR(150) NOT NULL,
  `quantity` INT(10) UNSIGNED NOT NULL,
  `paid` INT(10) UNSIGNED NOT NULL,
  `mode` TINYINT(3) UNSIGNED NOT NULL COMMENT '0 - PG (cc,netbanking), 1 - cod',
  `status` TINYINT(4) NOT NULL DEFAULT '0',
  `admin_order_status` TINYINT(3) DEFAULT '0',
  `shipped` TINYINT(1) NOT NULL,
  `buyer_options` TEXT NOT NULL,
  `time` BIGINT(20) NOT NULL,
  `actiontime` BIGINT(20) UNSIGNED NOT NULL,
  `shiptime` BIGINT(20) UNSIGNED NOT NULL,
  `shipid` VARCHAR(50) NOT NULL,
  `medium` VARCHAR(100) NOT NULL,
  `bpid` BIGINT(20) UNSIGNED NOT NULL,
  `email` VARCHAR(100) NOT NULL,
  `ship_landmark` TEXT NOT NULL,
  `bill_landmark` TEXT NOT NULL,
  `ship_telephone` VARCHAR(50) NOT NULL,
  `ship_country` VARCHAR(255) DEFAULT NULL,
  `bill_country` VARCHAR(255) DEFAULT NULL,
  `bill_telephone` VARCHAR(50) NOT NULL,
  `invoice_no` BIGINT(20) UNSIGNED NOT NULL,
  `priority` TINYINT(1) NOT NULL,
  `priority_note` VARCHAR(200) NOT NULL,
  `note` TEXT NOT NULL,
  `billon_orderprice` TINYINT(1) DEFAULT '0',
  `i_orgprice` DOUBLE DEFAULT '0',
  `i_price` DOUBLE DEFAULT '0',
  `i_nlc` DOUBLE DEFAULT '0',
  `i_phc` DOUBLE DEFAULT '0',
  `i_tax` DOUBLE DEFAULT '0',
  `i_discount` DOUBLE DEFAULT '0',
  `i_coup_discount` DOUBLE DEFAULT '0',
  `member_id` BIGINT(11) DEFAULT '0',
  `loyality_point_value` DOUBLE DEFAULT '0',
  `is_memberprice` TINYINT(1) DEFAULT '0',
  `other_price` DOUBLE DEFAULT '0',
  `mp_logid` BIGINT(11) DEFAULT '0',
  PRIMARY KEY (`sno`),
  KEY `transid` (`transid`),
  KEY `itemid` (`itemid`),
  KEY `userid` (`userid`),
  KEY `id` (`id`),
  KEY `status` (`status`)
);

#==============================================Consolidated payment==============================================================#
ALTER TABLE `pnh_m_franchise_info` ADD COLUMN `is_consolidated_payment` TINYINT(1) DEFAULT 0 NULL AFTER `price_type`;
ALTER TABLE `king_orders` ADD COLUMN `is_consolidated_payment` TINYINT(1) DEFAULT 0 NULL AFTER `mp_logid`; 
ALTER TABLE `t_invoice_credit_notes` ADD COLUMN `payment_id` BIGINT(11) DEFAULT 0 NULL AFTER `ref_id`; 
UPDATE t_invoice_credit_notes SET payment_id=1
CREATE TABLE `pnh_payment_info` (
  `payment_id` BIGINT(11) NOT NULL AUTO_INCREMENT,
  `franchise_id` BIGINT(11) DEFAULT NULL,
  `bank_id` BIGINT(11) DEFAULT NULL,
  `instrument_no` BIGINT(11) DEFAULT NULL,
  `instrument_date` DATE DEFAULT NULL,
  `drawn_inname` VARCHAR(255) DEFAULT NULL,
  `created_by` BIGINT(20) DEFAULT NULL,
  `created_on` DATETIME DEFAULT NULL,
  `cleared_on` DATETIME DEFAULT NULL,
  PRIMARY KEY (`payment_id`)
);
CREATE TABLE `creditnote_payment_linkinfo`( `id` BIGINT(11) NOT NULL AUTO_INCREMENT, `credit_note_id` BIGINT(11), `payment_id` BIGINT(11), `is_active` TINYINT(1) DEFAULT 1, `created_on` DATETIME, `created_by` TINYINT(1), `modified_on` DATETIME, `modified_by` TINYINT(1), PRIMARY KEY (`id`) ); 
CREATE TABLE `pnh_payment_flag_changelog` (
  `id` BIGINT(11) NOT NULL AUTO_INCREMENT,
  `franchise_id` BIGINT(11) DEFAULT NULL,
  `is_consolidated_payment` TINYINT(1) DEFAULT NULL,
  `reason` VARCHAR(255) DEFAULT NULL,
  `created_on` DATETIME DEFAULT NULL,
  `created_by` INT(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
);

 
ALTER TABLE `pnh_payment_info` ADD COLUMN `amount` DOUBLE NULL AFTER `franchise_id`;
#===============================================
#Jul_15_2014 - To filter the tickets by Web or APP-by Shivaraj
ALTER TABLE `support_tickets` ADD COLUMN `from_app` TINYINT(11) DEFAULT 0 NOT NULL COMMENT '0:from web,1:from api/app' AFTER `req_mem_mobile`;
ALTER TABLE `support_tickets` CHANGE `franchise_id` `franchise_id` BIGINT(20) DEFAULT 0 NULL;
#reset
UPDATE support_tickets SET franchise_id=0 WHERE franchise_id IS NULL;
UPDATE support_tickets SET from_app = 1 WHERE franchise_id != 0;
#======================================

#===============================================
#Jul_21_2014 - To allot towns for vendor-by Suresh
CREATE TABLE `m_vendor_town_link` (                       
                      `id` INT(11) NOT NULL AUTO_INCREMENT,                   
                      `brand_id` INT(11) DEFAULT NULL,                        
                      `vendor_id` INT(11) DEFAULT NULL,                       
                      `town_id` INT(11) DEFAULT NULL,                         
                      `is_active` TINYINT(1) DEFAULT '1',                     
                      `created_on` BIGINT(20) DEFAULT NULL,                   
                      `modified_on` BIGINT(20) DEFAULT NULL,                  
                      `modified_by` INT(11) DEFAULT '0',                      
                      PRIMARY KEY (`id`),                                     
                      UNIQUE KEY `id` (`id`)                                  
                    );

<!---Modification Done BY Roopashree<roopashree@storeking.in> Modified DATE 19/july/2014------>

#=============================Franchise Asset/Device Information====================================================#

/*[5:55:32 PM][63 ms]*/ CREATE TABLE `m_asset_info` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `asset_name` VARCHAR(255) DEFAULT NULL,
  `brand_id` BIGINT(20) DEFAULT NULL,
  `category_id` BIGINT(20) DEFAULT NULL,
  `created_date` DATETIME DEFAULT NULL,
  `created_by` INT(11) DEFAULT NULL,
  `modified_on` DATETIME DEFAULT NULL,
  `modified_by` INT(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
);

/*[5:57:22 PM][28 ms]*/ CREATE TABLE `m_asset_accessory_info` (
  `id` BIGINT(11) NOT NULL AUTO_INCREMENT,
  `asset_id` BIGINT(11) DEFAULT NULL,
  `accessory_name` VARCHAR(255) DEFAULT NULL,
  `is_active` TINYINT(1) DEFAULT '1',
  `created_on` DATETIME DEFAULT NULL,
  `created_by` INT(11) DEFAULT NULL,
  `modified_on` DATETIME DEFAULT NULL,
  `modified_by` INT(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ;

/*[6:00:23 PM][35 ms]*/ CREATE TABLE `m_franchise_asset_link` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `franchise_id` BIGINT(20) DEFAULT NULL,
  `asset_id` BIGINT(20) DEFAULT NULL,
  `accessory_id` BIGINT(20) DEFAULT NULL,
  `asset_serialno` VARCHAR(255) DEFAULT NULL,
  `is_active` TINYINT(1) DEFAULT '1',
  `created_on` BIGINT(20) DEFAULT NULL,
  `created_by` INT(11) DEFAULT NULL,
  `modified_on` BIGINT(20) DEFAULT NULL,
  `modified_by` INT(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
);

CREATE TABLE `m_franchise_store_link` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `franchise_id` BIGINT(20) DEFAULT NULL,
  `store_id` INT(11) DEFAULT NULL,
  `is_active` TINYINT(1) DEFAULT NULL,
  `created_on` BIGINT(20) DEFAULT NULL,
  `created_by` INT(11) DEFAULT NULL,
  `modified_on` BIGINT(20) DEFAULT NULL,
  `modified_by` INT(11) DEFAULT NULL,
  PRIMARY KEY (`id`)
); 

#=============================Franchise Store type Info====================================================#
#JUl_23_2014 - Master Franchise DB changes
CREATE TABLE `m_master_franchise_info` (  `id` INT (11) NOT NULL AUTO_INCREMENT , `name` VARCHAR (255) , `address` VARCHAR (2024) , `city` VARCHAR (255) , `state` VARCHAR (255) , `town_id` INT (11) DEFAULT '0', `terr_id` INT (11) DEFAULT '0', `created_on` DATETIME , `modified_on` DATETIME , `created_by` INT (11) DEFAULT '0', `modified_by` INT (11) DEFAULT '0', PRIMARY KEY ( `id`)) ;
ALTER TABLE `pnh_m_franchise_info` ADD COLUMN `master_franchise_id` INT (11) DEFAULT '0' NULL  AFTER `pnh_franchise_id`;
ALTER TABLE `pnh_users` CHANGE `franchise_id` `reference_id` BIGINT(20) NULL COMMENT 'franchise_id,m_fid';
#=============================
#Jul_24_2014
ALTER TABLE `t_imei_no` ADD COLUMN `reserved_batch_rowid` BIGINT(20) DEFAULT 0 NULL AFTER `modified_on`;
#=================================================
#Jul_24_2014
ALTER TABLE `products_src_changelog` ADD COLUMN `remarks` VARCHAR(200) NULL AFTER `is_sourceable`;
#=================================================
#Jul_26_2014
# Set mp log table shipsin value '24-48 Hrs' for all null of empty
UPDATE deal_member_price_changelog 
SET mp_offer_shipsin='24-48 Hrs'
WHERE mp_offer_shipsin IS NULL OR mp_offer_shipsin='';

#Set dealitems shipsin value to '24-48 Hrs' for all null of empty
UPDATE king_dealitems
SET shipsin='24-48 Hrs'
WHERE shipsin IS NULL OR shipsin='';

# Change ships in 24 to 48 Hrs TO 24-48 Hrs
UPDATE king_dealitems
SET shipsin='24-48 Hrs'
WHERE shipsin='24 to 48 Hrs';
#=====================================================
#Jul_31_2014
ALTER TABLE `t_imei_no` ADD COLUMN `reserved_on` BIGINT(20) DEFAULT 0 NULL AFTER `reserved_batch_rowid`; 

ALTER TABLE king_brands ADD INDEX (`name`);

#Index created
ALTER TABLE `m_vendor_product_images` ADD INDEX (`vendor_id`), ADD INDEX (`item_id`);
#================================================================

/*[1:47:50 PM][805 ms]*/ ALTER TABLE `t_reserved_batch_stock` ADD COLUMN `grn_id` BIGINT(11) DEFAULT 0 NULL AFTER `tmp_prev_stk_id`; 
#========== Table Indexes created =============================
#Aug_04_2014-Shivaraj
ALTER TABLE `m_product_deal_link` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_product_group_deal_link` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_rack_bin_info` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_rack_bin_info` ADD INDEX `is_damaged` (`is_damaged`);
ALTER TABLE `m_storage_location_info` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_stream_post_assigned_users` ADD INDEX `assigned_userid` (`assigned_userid`);
ALTER TABLE `m_stream_post_assigned_users` ADD INDEX `post_id` (`post_id`);
ALTER TABLE `m_stream_post_assigned_users` ADD INDEX `streamid` (`streamid`);
ALTER TABLE `m_stream_post_assigned_users` ADD INDEX `userid` (`userid`);
ALTER TABLE `m_stream_post_reply` ADD INDEX `post_id` (`post_id`);
ALTER TABLE `m_stream_post_reply` ADD INDEX `replied_by` (`replied_by`);
ALTER TABLE `m_stream_post_reply` ADD INDEX `status` (`status`);
ALTER TABLE `m_stream_posts` ADD INDEX `modified_by` (`modified_by`);
ALTER TABLE `m_stream_posts` ADD INDEX `posted_by` (`posted_by`);
ALTER TABLE `m_stream_posts` ADD INDEX `status` (`status`);
ALTER TABLE `m_stream_posts` ADD INDEX `stream_id` (`stream_id`);
ALTER TABLE `m_stream_users` ADD INDEX `access` (`access`);
ALTER TABLE `m_stream_users` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_stream_users` ADD INDEX `stream_id` (`stream_id`);
ALTER TABLE `m_stream_users` ADD INDEX `user_id` (`user_id`);
ALTER TABLE `m_town_territory_link` ADD INDEX `employee_id` (`employee_id`);
ALTER TABLE `m_town_territory_link` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_town_territory_link` ADD INDEX `parent_emp_id` (`parent_emp_id`);
ALTER TABLE `m_town_territory_link` ADD INDEX `territory_id` (`territory_id`);
ALTER TABLE `m_town_territory_link` ADD INDEX `town_id` (`town_id`);
ALTER TABLE `m_tray_info` ADD INDEX `max_allowed` (`max_allowed`);
ALTER TABLE `m_vendor_api_access` ADD INDEX `access_type` (`access_type`);
ALTER TABLE `m_vendor_api_access` ADD INDEX `vendor_id` (`vendor_id`);
ALTER TABLE `m_vendor_api_resources` ADD INDEX `api_access_id` (`api_access_id`);
ALTER TABLE `m_vendor_api_resources` ADD INDEX `mapping_tmpl_id` (`mapping_tmpl_id`);
ALTER TABLE `m_vendor_api_resources` ADD INDEX `module_type` (`module_type`);
ALTER TABLE `m_vendor_api_resources` ADD INDEX `vendor_id` (`vendor_id`);
ALTER TABLE `m_vendor_brand_link` ADD INDEX `applicable_from` (`applicable_from`);
ALTER TABLE `m_vendor_brand_link` ADD INDEX `applicable_till` (`applicable_till`);
ALTER TABLE `m_vendor_brand_link` ADD INDEX `cat_id` (`cat_id`);
ALTER TABLE `m_vendor_brand_link` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_vendor_contacts_info` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_vendor_contacts_info` ADD INDEX `mobile_no_1` (`mobile_no_1`);
ALTER TABLE `m_vendor_contacts_info` ADD INDEX `mobile_no_2` (`mobile_no_2`);
ALTER TABLE `m_vendor_info` ADD INDEX `api_access_key` (`api_access_key`);
ALTER TABLE `m_vendor_info` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_vendor_info` ADD INDEX `vendor_code` (`vendor_code`);
ALTER TABLE `m_vendor_product_link` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_vendor_product_link` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_vendor_product_link` ADD INDEX `ven_stock_qty` (`ven_stock_qty`);
ALTER TABLE `m_vendor_town_link` ADD INDEX `brand_id` (`brand_id`);
ALTER TABLE `m_vendor_town_link` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `m_vendor_town_link` ADD INDEX `vendor_id` (`vendor_id`);
ALTER TABLE `menu_class_config` ADD INDEX `class_id` (`class_id`);
ALTER TABLE `menu_class_config` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `menu_class_config` ADD INDEX `menu_id` (`menu_id`);
ALTER TABLE `non_sk_imei_insurance_orders` ADD INDEX `nonsk_imei_no` (`nonsk_imei_no`);
ALTER TABLE `nonskimei_mem_fee_insu_amt` ADD INDEX `invoice_no` (`invoice_no`);
ALTER TABLE `nonskimei_mem_fee_insu_amt` ADD INDEX `member_id` (`member_id`);
ALTER TABLE `nonskimei_mem_fee_insu_amt` ADD INDEX `status` (`status`);
ALTER TABLE `nonskimei_mem_fee_insu_amt` ADD INDEX `transid` (`transid`);
ALTER TABLE `partner_deal_prices` ADD INDEX `partner_id` (`partner_id`);
ALTER TABLE `partner_info` ADD INDEX `name` (`name`);
ALTER TABLE `partner_info` ADD INDEX `trans_prefix` (`trans_prefix`);
ALTER TABLE `partner_order_items` ADD INDEX `log_id` (`log_id`);
ALTER TABLE `partner_order_items` ADD INDEX `status` (`status`);
ALTER TABLE `partner_order_items` ADD INDEX `transid` (`transid`);
ALTER TABLE `partner_orders_log` ADD INDEX `is_payment_made` (`is_payment_made`);
ALTER TABLE `partner_orders_log` ADD INDEX `status` (`status`);
ALTER TABLE `partner_transaction_details` ADD INDEX `order_no` (`order_no`);
ALTER TABLE `picklist_log_reservation` ADD INDEX `batch_id` (`batch_id`);
ALTER TABLE `pnh_acknowledgement_print_log` ADD INDEX `be_emp_id` (`be_emp_id`);
ALTER TABLE `pnh_acknowledgement_print_log` ADD INDEX `log_id` (`log_id`);
ALTER TABLE `pnh_acknowledgement_print_log` ADD INDEX `p_inv_no` (`p_inv_no`);
ALTER TABLE `pnh_acknowledgement_print_log` ADD INDEX `tm_emp_id` (`tm_emp_id`);
ALTER TABLE `pnh_api_franchise_cart_info` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_api_franchise_cart_info` ADD INDEX `member_id` (`member_id`);
ALTER TABLE `pnh_api_franchise_cart_info` ADD INDEX `pid` (`pid`);
ALTER TABLE `pnh_api_franchise_cart_info` ADD INDEX `status` (`status`);
ALTER TABLE `pnh_api_franchise_cart_info` ADD INDEX `user_id` (`user_id`);
ALTER TABLE `pnh_api_franchise_compaints` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_app_versions` ADD INDEX `version_date` (`version_date`);
ALTER TABLE `pnh_bussiness_trip_info` ADD INDEX `f_id` (`f_id`);
ALTER TABLE `pnh_bussiness_trip_info` ADD INDEX `task_id` (`task_id`);
ALTER TABLE `pnh_call_log` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_cash_bill` ADD INDEX `bill_no` (`bill_no`);
ALTER TABLE `pnh_cash_bill` ADD INDEX `status` (`status`);
ALTER TABLE `pnh_cash_bill` ADD INDEX `transid` (`transid`);
ALTER TABLE `pnh_cash_bill` ADD INDEX `user_id` (`user_id`);
ALTER TABLE `pnh_deliveryhub_fc_link` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `pnh_deliveryhub_town_link` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `pnh_deliveryhub` ADD INDEX `is_active` (`is_active`);
ALTER TABLE `pnh_employee_grpsms_log` ADD INDEX `emp_id` (`emp_id`);
ALTER TABLE `pnh_employee_grpsms_log` ADD INDEX `territory_id` (`territory_id`);
ALTER TABLE `pnh_employee_grpsms_log` ADD INDEX `town_id` (`town_id`);
ALTER TABLE `pnh_employee_grpsms_log` ADD INDEX `type` (`type`);
ALTER TABLE `pnh_executive_accounts_log` ADD INDEX `emp_id` (`emp_id`);
ALTER TABLE `pnh_franchise_account_stat` ADD INDEX `ref_id` (`ref_id`);
ALTER TABLE `pnh_franchise_account_summary` ADD INDEX `action_type` (`action_type`);
ALTER TABLE `pnh_franchise_account_summary` ADD INDEX `cheque_no` (`cheque_no`);
ALTER TABLE `pnh_franchise_account_summary` ADD INDEX `credit_note_id` (`credit_note_id`);
ALTER TABLE `pnh_franchise_account_summary` ADD INDEX `receipt_id` (`receipt_id`);
ALTER TABLE `pnh_franchise_menu_link` ADD INDEX `sch_discount_end` (`sch_discount_end`);
ALTER TABLE `pnh_franchise_menu_link` ADD INDEX `sch_discount_start` (`sch_discount_start`);
ALTER TABLE `pnh_franchise_owners` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_franchise_pprice_enqrylog` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_franchise_pprice_enqrylog` ADD INDEX `pid` (`pid`);
ALTER TABLE `pnh_franchise_prepaid_log` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_franchise_price_quote` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_franchise_price_quote` ADD INDEX `pid` (`pid`);
ALTER TABLE `pnh_franchise_unorderd_log` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_invoice_return` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_invoice_return` ADD INDEX `invoice_no` (`invoice_no`);
ALTER TABLE `pnh_invoice_returns_flags` ADD INDEX `name` (`name`);
ALTER TABLE `pnh_invoice_returns_product_link` ADD INDEX `imei_no` (`imei_no`);
ALTER TABLE `pnh_invoice_returns_product_link` ADD INDEX `order_id` (`order_id`);
ALTER TABLE `pnh_invoice_returns_product_link` ADD INDEX `product_id` (`product_id`);
ALTER TABLE `pnh_invoice_returns_product_link` ADD INDEX `return_id` (`return_id`);
ALTER TABLE `pnh_invoice_returns_product_service` ADD INDEX `return_prod_id` (`return_prod_id`);
ALTER TABLE `pnh_invoice_returns_remarks` ADD INDEX `parent_id` (`parent_id`);
ALTER TABLE `pnh_invoice_returns_remarks` ADD INDEX `return_prod_id` (`return_prod_id`);
ALTER TABLE `pnh_invoice_returns` ADD INDEX `handled_by` (`handled_by`);
ALTER TABLE `pnh_invoice_returns` ADD INDEX `invoice_no` (`invoice_no`);
ALTER TABLE `pnh_invoice_returns` ADD INDEX `return_by` (`return_by`);
ALTER TABLE `pnh_invoice_transit_log` ADD INDEX `ref_id` (`ref_id`);
ALTER TABLE `pnh_invoice_transit_log` ADD INDEX `sent_log_id` (`sent_log_id`);
ALTER TABLE `pnh_less_margin_brands` ADD INDEX `brandid` (`brandid`);
ALTER TABLE `pnh_loyalty_points` ADD INDEX `menu_id` (`menu_id`);
ALTER TABLE `pnh_m_allotted_mid` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_m_allotted_mid` ADD INDEX `mid_end` (`mid_end`);
ALTER TABLE `pnh_m_allotted_mid` ADD INDEX `mid_start` (`mid_start`);
ALTER TABLE `pnh_m_book_template_voucher_link` ADD INDEX `book_template_id` (`book_template_id`);
ALTER TABLE `pnh_m_book_template_voucher_link` ADD INDEX `voucher_id` (`voucher_id`);
ALTER TABLE `pnh_m_book_template` ADD INDEX `menu_ids` (`menu_ids`);
ALTER TABLE `pnh_m_book_template` ADD INDEX `product_id` (`product_id`);
ALTER TABLE `pnh_m_coupons` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_m_coupons` ADD INDEX `member_id` (`member_id`);
ALTER TABLE `pnh_m_creditlimit_onprepaid` ADD INDEX `book_id` (`book_id`);
ALTER TABLE `pnh_m_creditlimit_onprepaid` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_m_creditlimit_onprepaid` ADD INDEX `receipt_id` (`receipt_id`);
ALTER TABLE `pnh_m_deposited_receipts` ADD INDEX `bank_id` (`bank_id`);
ALTER TABLE `pnh_m_device_info` ADD INDEX `device_type_id` (`device_type_id`);
ALTER TABLE `pnh_m_employee_leaves` ADD INDEX `emp_id` (`emp_id`);
ALTER TABLE `pnh_m_fran_security_cheques` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_m_franchise_info` ADD INDEX `class_id` (`class_id`);
ALTER TABLE `pnh_m_franchise_info` ADD INDEX `pnh_franchise_id` (`pnh_franchise_id`);
ALTER TABLE `pnh_m_franchise_info` ADD INDEX `territory_id` (`territory_id`);
ALTER TABLE `pnh_m_franchise_info` ADD INDEX `town_id` (`town_id`);
ALTER TABLE `pnh_m_franchise_search_log` ADD INDEX `fid` (`fid`);
ALTER TABLE `pnh_m_franchise_search_log` CHANGE `total_results` `total_results` INT (5) DEFAULT '0' NULL ;
ALTER TABLE `pnh_m_insurance_menu` ADD INDEX `menu_id` (`menu_id`);
ALTER TABLE `pnh_m_manifesto_sent_log` ADD INDEX `bus_id` (`bus_id`);
ALTER TABLE `pnh_m_manifesto_sent_log` ADD INDEX `sent_invoices` (`sent_invoices`);
ALTER TABLE `pnh_m_offers` ADD INDEX `brand_id` (`brand_id`);
ALTER TABLE `pnh_m_offers` ADD INDEX `cat_id` (`cat_id`);
ALTER TABLE `pnh_m_offers` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_m_offers` ADD INDEX `menu_id` (`menu_id`);
ALTER TABLE `pnh_m_payment_collection` ADD INDEX `f_id` (`f_id`);
ALTER TABLE `pnh_m_payment_collection` ADD INDEX `task_id` (`task_id`);
ALTER TABLE `pnh_m_sales_target_info` ADD INDEX `f_id` (`f_id`);
ALTER TABLE `pnh_m_sales_target_info` ADD INDEX `task_id` (`task_id`);
ALTER TABLE `pnh_m_task_info` ADD INDEX `asgnd_town_id` (`asgnd_town_id`);
ALTER TABLE `pnh_m_task_info` ADD INDEX `ref_no` (`ref_no`);
ALTER TABLE `pnh_m_task_types` ADD INDEX `task_type` (`task_type`);
ALTER TABLE `pnh_m_territory_info` ADD INDEX `state_id` (`state_id`);
ALTER TABLE `pnh_m_uploaded_depositedslips` ADD INDEX `deposited_reference_no` (`deposited_reference_no`);
ALTER TABLE `pnh_m_uploaded_depositedslips` ADD INDEX `receipt_ids` (`receipt_ids`);
ALTER TABLE `pnh_manifesto_log` ADD FULLTEXT `invoice_nos` (`invoice_nos`);
ALTER TABLE `pnh_manifesto_log` ADD INDEX `invoice_nos` (`invoice_nos`);
ALTER TABLE `pnh_member_offers_log` ADD INDEX `offer_sno` (`offer_sno`);
ALTER TABLE `pnh_member_offers_log` ADD INDEX `offer_type` (`offer_type`);
ALTER TABLE `pnh_member_points_track` ADD INDEX `transid` (`transid`);
ALTER TABLE `pnh_member_points_track` ADD INDEX `user_id` (`user_id`);
ALTER TABLE `pnh_membersch_deals` ADD INDEX `itemid` (`itemid`);
ALTER TABLE `pnh_membersch_deals` ADD INDEX `menuid` (`menuid`);
ALTER TABLE `pnh_menu_group_link` ADD INDEX `group_id` (`group_id`);
ALTER TABLE `pnh_menu_group_link` ADD INDEX `menu_id` (`menu_id`);
ALTER TABLE `pnh_menu_margin_track` ADD INDEX `menu_id` (`menu_id`);
ALTER TABLE `pnh_order_margin_track` ADD INDEX `itemid` (`itemid`);
ALTER TABLE `pnh_prepaid_menu_config` ADD INDEX `menu_id` (`menu_id`);
ALTER TABLE `pnh_quotes_deal_link` ADD INDEX `pnh_id` (`pnh_id`);
ALTER TABLE `pnh_sch_discount_track` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_ship_remarksupdate_log` ADD INDEX `ship_msg_id` (`ship_msg_id`);
ALTER TABLE `pnh_ship_remarksupdate_log` ADD INDEX `ticket_id` (`ticket_id`);
ALTER TABLE `pnh_sms_log_sent` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_sms_log_sent` ADD INDEX `pnh_empid` (`pnh_empid`);
ALTER TABLE `pnh_sms_log_sent` ADD INDEX `pnh_mid` (`pnh_mid`);
ALTER TABLE `pnh_sms_log_sent` ADD INDEX `ticket_id` (`ticket_id`);
ALTER TABLE `pnh_sms_log_sent` ADD INDEX `to` (`to`);
ALTER TABLE `pnh_special_margin_deals` ADD INDEX `from` (`from`);
ALTER TABLE `pnh_special_margin_deals` ADD INDEX `to` (`to`);
ALTER TABLE `pnh_super_scheme` ADD INDEX `brand_id` (`brand_id`);
ALTER TABLE `pnh_super_scheme` ADD INDEX `cat_id` (`cat_id`);
ALTER TABLE `pnh_super_scheme` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_super_scheme` ADD INDEX `menu_id` (`menu_id`);
ALTER TABLE `pnh_super_scheme` ADD INDEX `schme_discount_id` (`schme_discount_id`);
ALTER TABLE `pnh_superscheme_deals` ADD INDEX `itemid` (`itemid`);
ALTER TABLE `pnh_superscheme_deals` ADD INDEX `menuid` (`menuid`);
ALTER TABLE `pnh_t_book_allotment` ADD INDEX `allotment_id` (`allotment_id`);
ALTER TABLE `pnh_t_book_allotment` ADD INDEX `book_id` (`book_id`);
ALTER TABLE `pnh_t_book_allotment` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_t_book_details` ADD INDEX `book_slno` (`book_slno`);
ALTER TABLE `pnh_t_book_details` ADD INDEX `book_template_id` (`book_template_id`);
ALTER TABLE `pnh_t_book_receipt_link` ADD INDEX `book_id` (`book_id`);
ALTER TABLE `pnh_t_book_receipt_link` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_t_book_receipt_link` ADD INDEX `receipt_id` (`receipt_id`);
ALTER TABLE `pnh_t_book_voucher_link` ADD INDEX `book_id` (`book_id`);
ALTER TABLE `pnh_t_book_voucher_link` ADD INDEX `voucher_slno_id` (`voucher_slno_id`);
ALTER TABLE `pnh_t_credit_info` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_t_device_movement_info` ADD INDEX `device_id` (`device_id`);
ALTER TABLE `pnh_t_returns_transit_log` ADD INDEX `order_id` (`order_id`);
ALTER TABLE `pnh_t_returns_transit_log` ADD INDEX `return_id` (`return_id`);
ALTER TABLE `pnh_t_returns_transit_log` ADD INDEX `ticket_id` (`ticket_id`);
ALTER TABLE `pnh_t_tray_invoice_link` ADD INDEX `invoice_no` (`invoice_no`);
ALTER TABLE `pnh_t_tray_invoice_link` ADD INDEX `tray_terr_id` (`tray_terr_id`);
ALTER TABLE `pnh_t_tray_territory_link` ADD INDEX `territory_id` (`territory_id`);
ALTER TABLE `pnh_t_tray_territory_link` ADD INDEX `tray_id` (`tray_id`);
ALTER TABLE `pnh_t_voucher_details` ADD INDEX `franchise_id` (`franchise_id`);
ALTER TABLE `pnh_t_voucher_details` ADD INDEX `group_code` (`group_code`);
ALTER TABLE `pnh_t_voucher_details` ADD INDEX `member_id` (`member_id`);
ALTER TABLE `pnh_t_voucher_details` ADD INDEX `voucher_id` (`voucher_id`);
ALTER TABLE `pnh_t_voucher_details` ADD INDEX `voucher_serial_no` (`voucher_serial_no`);
ALTER TABLE `pnh_task_remarks` ADD INDEX `emp_id` (`emp_id`);
ALTER TABLE `pnh_task_remarks` ADD INDEX `task_id` (`task_id`);
ALTER TABLE `pnh_task_type_details` ADD INDEX `f_id` (`f_id`);
ALTER TABLE `pnh_task_type_details` ADD INDEX `task_id` (`task_id`);
ALTER TABLE `pnh_task_type_details` ADD INDEX `task_type_id` (`task_type_id`);
#========== Table Indexes created =============================
#============ search api log =========================
#Aug_04_2014-Shivaraj
CREATE TABLE `pnh_m_franchise_search_log` (
	`id` BIGINT(11) NOT NULL AUTO_INCREMENT,
	`elapsed_time` DECIMAL(20,4) DEFAULT '0.0000',
	`memory_usage` DECIMAL(20,4) DEFAULT '0.0000',
	`loaded_queries` TEXT,
	`fid` INT(11) DEFAULT '0',
	`srch_kwd` VARCHAR(255) DEFAULT NULL,
	`req_data` TEXT,
	`total_results` INT(5) DEFAULT '0',
	`logged_on` DATETIME DEFAULT NULL,
	`responded_on` DATETIME DEFAULT NULL,
	PRIMARY KEY (`id`),
	KEY `fid` (`fid`)
);
ALTER TABLE `pnh_m_franchise_search_log` ADD COLUMN `last_query` TEXT NULL AFTER `responded_on`;
ALTER TABLE `pnh_m_franchise_search_log` ADD COLUMN `type` VARCHAR(100) NULL AFTER `last_query`;
#============ search api log =========================

#============ Towns allotted for vendor by brand =========================
#Aug_06_2014-Suresh
CREATE TABLE `m_vendor_town_link` (                       
                      `id` INT(11) NOT NULL AUTO_INCREMENT,                   
                      `brand_id` INT(11) DEFAULT NULL,                        
                      `vendor_id` INT(11) DEFAULT NULL,                       
                      `town_id` INT(11) DEFAULT NULL,                         
                      `is_active` TINYINT(1) DEFAULT '1',                     
                      `created_on` BIGINT(20) DEFAULT NULL,                   
                      `modified_on` BIGINT(20) DEFAULT NULL,                  
                      `modified_by` INT(11) DEFAULT '0',                      
                      PRIMARY KEY (`id`),                                     
                      UNIQUE KEY `id` (`id`)                                  
                    );
#============ Towns allotted for vendor by brand =========================
#=============< MP Loyalty Points DB changes >==================
#Aug_07_2014-Shivaraj
CREATE TABLE `mp_loyaltypoint_brand_cat_config`( `id` BIGINT NOT NULL AUTO_INCREMENT, `brandid` BIGINT, `catid` BIGINT, `offernote_tmpl` TEXT, `is_active` TINYINT(1) DEFAULT 1, `created_on` DATETIME, `created_by` INT(11), `modified_on` DATETIME, `modified_by` INT(11), PRIMARY KEY (`id`) );
#Indexes
ALTER TABLE `mp_loyaltypoint_brand_cat_config` ADD INDEX (`brandid`), ADD INDEX (`catid`), ADD INDEX (`is_active`);
ALTER TABLE `mp_loyaltypoint_brand_cat_config` ADD COLUMN `menuid` BIGINT(20) NULL AFTER `id`;
#=============< MP Loyalty Points DB changes >==================

#============ Partner Deal Link table =========================
#Aug_07_2014-Suresh
CREATE TABLE `m_partner_deal_link` (    
                       `id` INT(11) NOT NULL,                
                       `itemid` BIGINT(20) DEFAULT NULL,     
                       `asin` VARCHAR(255) DEFAULT NULL,     
                       `fsin` VARCHAR(255) DEFAULT NULL,     
                       `created_by` INT(11) DEFAULT NULL,    
                       `created_on` DATE DEFAULT NULL,       
                       PRIMARY KEY (`id`)                    
                     );
#============ Partner Deal Link table =========================		     
#Aug_09_2014-Shivaraj
ALTER TABLE king_dealitems ADD COLUMN free_frame TINYINT(1) DEFAULT 0;
ALTER TABLE king_dealitems ADD COLUMN has_power TINYINT(1) DEFAULT 0;
#======================<< Loyalty Points added to orders table >>=========================
#Aug_09_2014-Shivaraj
ALTER TABLE `king_orders` ADD COLUMN `mp_loyalty_points` DOUBLE(10,2) DEFAULT 0 NULL AFTER `mp_logid`;
#===============================================